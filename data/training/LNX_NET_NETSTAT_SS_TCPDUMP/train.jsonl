{"instruction":"I need to see all current network connections on the server","input":{},"output":{"tool_call":{"tool":"ss_list_socket_connections_filter","parameters":{"protocol":"all","state":"all"}},{"action_result":"Total: 67 connections (12 LISTEN, 45 ESTAB, 8 TIME_WAIT, 2 CLOSE_WAIT)"}}}
{"instruction":"Check if anything is listening on port 8080 that shouldn't be there","input":{},"output":{"tool_call":{"tool":"lsof_list_network_connections_files","parameters":{"filter_type":"port","filter_value":"8080"}},{"action_result":"Java application PID 5432 listening on *:8080, appears to be Tomcat"}}}
{"instruction":"Capture some packets on the main interface to see what traffic is flowing","input":{},"output":{"tool_call":{"tool":"tcpdump_capture_filter_packets","parameters":{"interface":"eth0","filter":"","count":"50"}},{"action_result":"Captured 50 packets: HTTP(23), HTTPS(18), SSH(6), DNS(3)"}}}
{"instruction":"The database port should only be accessible locally. Verify this","input":{},"output":{"tool_call":{"tool":"netstat_show_routing_statistics","parameters":{"info_type":"listening"}},{"action_result":"MySQL on 127.0.0.1:3306 only - correctly bound to localhost"}}}
{"instruction":"Our firewall might be blocking legitimate traffic. Show me the rules","input":{},"output":{"tool_call":{"tool":"iptables_show_firewall_rules_chains","parameters":{"chain":"INPUT","table":"filter"}},{"action_result":"DEFAULT DROP policy, ACCEPT rules for 22,80,443. Missing rule for 8080!"}}}
{"instruction":"Scan our web server to see what ports are actually exposed to the internet","input":{},"output":{"tool_call":{"tool":"nmap_scan_ports_services_hosts","parameters":{"target":"webserver.company.com","scan_type":"version"}},{"action_result":"Open ports: 22(OpenSSH 8.9), 80(nginx 1.18), 443(nginx 1.18), 3306(MySQL filtered)"}}}
{"instruction":"Users are complaining about slow connections. Check the route to our API server","input":{},"output":{"tool_call":{"tool":"traceroute_mtr_network_path_analysis","parameters":{"destination":"api.company.com","tool_type":"mtr"}},{"action_result":"12 hops, hop 7 has 30% packet loss (ISP router 172.20.0.1)"}}}
{"instruction":"Show me only established TCP connections to see active sessions","input":{},"output":{"tool_call":{"tool":"ss_list_socket_connections_filter","parameters":{"protocol":"tcp","state":"established"}},{"action_result":"56 active sessions: web clients(34), SSH sessions(8), database connections(12), API calls(2)"}}}
{"instruction":"Get routing table to verify default gateway is correct","input":{},"output":{"tool_call":{"tool":"netstat_show_routing_statistics","parameters":{"info_type":"routing"}},{"action_result":"Default: 0.0.0.0 via 192.168.1.1 (eth0), 10.0.0.0/8 via 10.0.0.1 (eth1), 192.168.1.0/24 direct (eth0)"}}}
{"instruction":"Capture HTTPS traffic to see if there's a problem with SSL handshakes","input":{},"output":{"tool_call":{"tool":"tcpdump_capture_filter_packets","parameters":{"interface":"eth0","filter":"port 443","count":"30"}},{"action_result":"30 packets: SSL handshakes completing normally, no retransmissions detected"}}}
{"instruction":"Find out which application is making all these connections to port 5432","input":{},"output":{"tool_call":{"tool":"lsof_list_network_connections_files","parameters":{"filter_type":"port","filter_value":"5432"}},{"action_result":"Django app PID 7654 with 45 connections to PostgreSQL, connection pooling working"}}}
{"instruction":"Check the NAT rules to see how port forwarding is configured","input":{},"output":{"tool_call":{"tool":"iptables_show_firewall_rules_chains","parameters":{"chain":"PREROUTING","table":"nat"}},{"action_result":"DNAT rules: external:80->internal:8080, external:443->internal:8443"}}}
{"instruction":"Do a comprehensive port scan on our internal database server","input":{},"output":{"tool_call":{"tool":"nmap_scan_ports_services_hosts","parameters":{"target":"10.0.0.50","scan_type":"full"}},{"action_result":"Scan complete: 3306(mysql), 5432(postgresql), 6379(redis), 27017(mongodb) all open"}}}
{"instruction":"Test connectivity and measure latency to the backup server","input":{},"output":{"tool_call":{"tool":"traceroute_mtr_network_path_analysis","parameters":{"destination":"backup.company.com","tool_type":"mtr"}},{"action_result":"8 hops, 0% loss, avg latency 23ms - connection healthy"}}}
{"instruction":"How many connections are stuck in TIME_WAIT? We might have an issue","input":{},"output":{"tool_call":{"tool":"ss_list_socket_connections_filter","parameters":{"protocol":"tcp","state":"time-wait"}},{"action_result":"234 connections in TIME_WAIT - high but normal for busy web server"}}}
{"instruction":"Check network interface statistics for errors or drops","input":{},"output":{"tool_call":{"tool":"netstat_show_routing_statistics","parameters":{"info_type":"stats"}},{"action_result":"TCP: 45678 segments sent, 234 retransmitted, 12 failed. UDP: 8901 sent, 0 errors"}}}
{"instruction":"Capture packets between our server and the database to debug query slowness","input":{},"output":{"tool_call":{"tool":"tcpdump_capture_filter_packets","parameters":{"interface":"eth0","filter":"host 10.0.0.50 and port 3306","count":"25"}},{"action_result":"25 MySQL packets captured: query taking 3+ seconds to return results"}}}
{"instruction":"List all network connections owned by the www-data user","input":{},"output":{"tool_call":{"tool":"lsof_list_network_connections_files","parameters":{"filter_type":"user","filter_value":"www-data"}},{"action_result":"www-data: 156 connections (nginx workers handling HTTP/HTTPS traffic)"}}}
{"instruction":"Show me the firewall rules in a format I can save for documentation","input":{},"output":{"tool_call":{"tool":"iptables_show_firewall_rules_chains","parameters":{"chain":"","table":"filter"}},{"action_result":"Complete ruleset: INPUT(5 rules), FORWARD(1 rule), OUTPUT(0 rules, ACCEPT all)"}}}
{"instruction":"Quick scan of our local network to find all active devices","input":{},"output":{"tool_call":{"tool":"nmap_scan_ports_services_hosts","parameters":{"target":"192.168.1.0/24","scan_type":"quick"}},{"action_result":"Found 47 active hosts: servers(12), workstations(28), network devices(7)"}}}
{"instruction":"Someone said they can't reach our server. Trace the route from here","input":{},"output":{"tool_call":{"tool":"traceroute_mtr_network_path_analysis","parameters":{"destination":"problematic-client.com","tool_type":"traceroute"}},{"action_result":"Traceroute stops at hop 8 - appears to be firewall blocking ICMP beyond that point"}}}
{"instruction":"Count active connections per state to understand server load","input":{},"output":{"tool_call":{"tool":"ss_list_socket_connections_filter","parameters":{"protocol":"tcp","state":"all"}},{"action_result":"State distribution: LISTEN(8), ESTAB(67), TIME_WAIT(123), CLOSE_WAIT(4), FIN_WAIT(2)"}}}
{"instruction":"Capture DNS traffic to see why name resolution is slow","input":{},"output":{"tool_call":{"tool":"tcpdump_capture_filter_packets","parameters":{"interface":"any","filter":"port 53","count":"20"}},{"action_result":"20 DNS queries: high latency responses from 8.8.8.8 (200-500ms), consider local DNS"}}}
{"instruction":"Check which processes have TCP connections established","input":{},"output":{"tool_call":{"tool":"lsof_list_network_connections_files","parameters":{"filter_type":"tcp","filter_value":""}},{"action_result":"nginx(67), mysqld(23), sshd(8), redis(12), memcached(5) - total 115 connections"}}}
{"instruction":"Verify the firewall isn't blocking our monitoring tool on port 9100","input":{},"output":{"tool_call":{"tool":"iptables_show_firewall_rules_chains","parameters":{"chain":"INPUT","table":"filter"}},{"action_result":"No rule for 9100, default policy DROP - monitoring traffic is being blocked!"}}}
{"instruction":"Scan the mail server for open SMTP and IMAP ports","input":{},"output":{"tool_call":{"tool":"nmap_scan_ports_services_hosts","parameters":{"target":"mail.company.com","scan_type":"quick"}},{"action_result":"Open: 25(SMTP Postfix), 587(submission), 993(IMAPS), 995(POP3S)"}}}
{"instruction":"Analyze the network path to our cloud provider to check for routing issues","input":{},"output":{"tool_call":{"tool":"traceroute_mtr_network_path_analysis","parameters":{"destination":"cloud.provider.com","tool_type":"mtr"}},{"action_result":"15 hops, stable route, 0% loss, average 45ms - no routing problems detected"}}}
{"instruction":"Show me UDP connections since we're having VOIP quality issues","input":{},"output":{"tool_call":{"tool":"ss_list_socket_connections_filter","parameters":{"protocol":"udp","state":""}},{"action_result":"UDP sockets: DNS(53), NTP(123), VOIP(5060-5080 range with 23 active sessions)"}}}
{"instruction":"Check TCP statistics to see if we're having retransmission problems","input":{},"output":{"tool_call":{"tool":"netstat_show_routing_statistics","parameters":{"info_type":"stats"}},{"action_result":"TCP stats: 5.2% retransmission rate (normal <3%), 890 out-of-order packets received"}}}
{"instruction":"Record network traffic to a file for the security team to analyze","input":{},"output":{"tool_call":{"tool":"tcpdump_capture_filter_packets","parameters":{"interface":"eth0","filter":"not port 22","count":"200"}},{"action_result":"200 packets saved to /tmp/capture.pcap (excluding SSH), file size 156KB"}}}
