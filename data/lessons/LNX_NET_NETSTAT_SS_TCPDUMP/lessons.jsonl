{"instruction":"Show me all active TCP connections on this server","input":{},"output":{"tool":"ss_list_socket_connections_filter","action":"ss -tn state established","result":"23 established TCP connections: 8 SSH, 12 HTTP, 3 MySQL"}}
{"instruction":"List all processes listening on network ports","input":{},"output":{"tool":"lsof_list_network_connections_files","action":"lsof -i -P -n | grep LISTEN","result":"sshd:22, nginx:80, nginx:443, mysqld:3306, redis:6379"}}
{"instruction":"Capture HTTP traffic on port 80 for analysis","input":{},"output":{"tool":"tcpdump_capture_filter_packets","action":"tcpdump -i eth0 port 80 -c 20","result":"Captured 20 HTTP packets, 15 GET requests, 5 POST requests"}}
{"instruction":"Check what's using port 3306 on the database server","input":{},"output":{"tool":"lsof_list_network_connections_files","action":"lsof -i :3306 -P -n","result":"mysqld PID 9012 listening on *:3306 with 47 active connections"}}
{"instruction":"Show current routing table configuration","input":{},"output":{"tool":"netstat_show_routing_statistics","action":"netstat -rn","result":"Default gateway 192.168.1.1 via eth0, local network 192.168.1.0/24"}}
{"instruction":"Display all firewall rules with packet counters","input":{},"output":{"tool":"iptables_show_firewall_rules_chains","action":"iptables -L -v -n","result":"INPUT: 1234 packets accepted, 56 dropped. SSH(22), HTTP(80), HTTPS(443) allowed"}}
{"instruction":"Scan web server for open ports","input":{},"output":{"tool":"nmap_scan_ports_services_hosts","action":"nmap -F 192.168.1.100","result":"Ports 22, 80, 443 open. Port 3306 filtered"}}
{"instruction":"Trace network path to Google DNS","input":{},"output":{"tool":"traceroute_mtr_network_path_analysis","action":"traceroute 8.8.8.8","result":"6 hops: local router -> ISP gateway -> internet backbone -> Google"}}
{"instruction":"Show all UDP connections and listening ports","input":{},"output":{"tool":"ss_list_socket_connections_filter","action":"ss -un","result":"DNS queries on :53, DHCP client on :68, NTP sync on :123"}}
{"instruction":"Get network statistics for troubleshooting","input":{},"output":{"tool":"netstat_show_routing_statistics","action":"netstat -s","result":"12345 TCP connections, 234 retransmits, 56 failed attempts"}}
{"instruction":"Capture packets from specific IP address","input":{},"output":{"tool":"tcpdump_capture_filter_packets","action":"tcpdump -i eth0 host 192.168.1.50 -c 10","result":"Captured 10 packets: HTTP and SSH traffic to/from 192.168.1.50"}}
{"instruction":"List all network connections by process name nginx","input":{},"output":{"tool":"lsof_list_network_connections_files","action":"lsof -c nginx -i -P -n","result":"Nginx master + 4 workers, 67 established connections on ports 80 and 443"}}
{"instruction":"Show INPUT chain firewall rules with line numbers","input":{},"output":{"tool":"iptables_show_firewall_rules_chains","action":"iptables -L INPUT -v -n --line-numbers","result":"5 rules: ACCEPT ssh(22), http(80), https(443); DROP from 192.168.100.0/24"}}
{"instruction":"Scan for running web services and versions","input":{},"output":{"tool":"nmap_scan_ports_services_hosts","action":"nmap -sV -p 80,443 webserver.local","result":"Port 80: nginx 1.18.0, Port 443: nginx 1.18.0 (SSL)"}}
{"instruction":"Run MTR to diagnose packet loss to remote server","input":{},"output":{"tool":"traceroute_mtr_network_path_analysis","action":"mtr --report --report-cycles 10 api.example.com","result":"Hop 3 showing 15% packet loss, average latency 45ms"}}
{"instruction":"Count how many connections are in TIME_WAIT state","input":{},"output":{"tool":"ss_list_socket_connections_filter","action":"ss -tn state time-wait | wc -l","result":"156 connections in TIME_WAIT state (possible connection exhaustion)"}}
{"instruction":"Check which user owns the connections","input":{},"output":{"tool":"lsof_list_network_connections_files","action":"lsof -u www-data -i","result":"www-data owns 89 connections: all nginx workers"}}
{"instruction":"Capture only TCP SYN packets for connection analysis","input":{},"output":{"tool":"tcpdump_capture_filter_packets","action":"tcpdump -i eth0 'tcp[tcpflags] & tcp-syn != 0' -c 20","result":"Captured 20 SYN packets: new connection attempts from 15 different IPs"}}
{"instruction":"Show NAT table rules for port forwarding","input":{},"output":{"tool":"iptables_show_firewall_rules_chains","action":"iptables -t nat -L -v -n","result":"PREROUTING: port 80 forwarded to 192.168.1.10:8080"}}
{"instruction":"Quick scan local network for active hosts","input":{},"output":{"tool":"nmap_scan_ports_services_hosts","action":"nmap -sn 192.168.1.0/24","result":"Found 23 active hosts in 192.168.1.0/24 network"}}
{"instruction":"Get statistics on network interface eth0","input":{},"output":{"tool":"netstat_show_routing_statistics","action":"netstat -i | grep eth0","result":"eth0: 1234567 RX packets, 987654 TX packets, 0 errors"}}
{"instruction":"List all connections to port 443 (HTTPS)","input":{},"output":{"tool":"ss_list_socket_connections_filter","action":"ss -tn sport = :443","result":"34 HTTPS connections established from various client IPs"}}
{"instruction":"Save packet capture to file for later analysis","input":{},"output":{"tool":"tcpdump_capture_filter_packets","action":"tcpdump -i eth0 -c 100 -w /tmp/capture.pcap","result":"100 packets saved to /tmp/capture.pcap (42KB)"}}
{"instruction":"Find what process is making connections to external API","input":{},"output":{"tool":"lsof_list_network_connections_files","action":"lsof -i | grep api.example.com","result":"python3 PID 7890 has 5 established connections to api.example.com:443"}}
{"instruction":"Check if firewall is blocking port 8080","input":{},"output":{"tool":"iptables_show_firewall_rules_chains","action":"iptables -L INPUT -v -n | grep 8080","result":"No rule for port 8080 - default policy will apply (DROP)"}}
{"instruction":"Scan for commonly vulnerable ports","input":{},"output":{"tool":"nmap_scan_ports_services_hosts","action":"nmap -p 21,22,23,25,80,443,3306,3389 target.local","result":"Open: 22(ssh), 80(http), 443(https). Closed: 21,23,25,3306,3389"}}
{"instruction":"Trace route with ICMP packets instead of UDP","input":{},"output":{"tool":"traceroute_mtr_network_path_analysis","action":"traceroute -I remote-server.com","result":"8 hops traced via ICMP, average 67ms latency"}}
{"instruction":"Show all LISTENING and ESTABLISHED TCP connections","input":{},"output":{"tool":"ss_list_socket_connections_filter","action":"ss -tn state listening state established","result":"12 listening ports, 45 established connections"}}
{"instruction":"Get interface statistics to check for packet drops","input":{},"output":{"tool":"netstat_show_routing_statistics","action":"netstat -s | grep -i drop","result":"127 packets dropped due to buffer overflow, 23 due to errors"}}
{"instruction":"Capture DNS queries for debugging resolution issues","input":{},"output":{"tool":"tcpdump_capture_filter_packets","action":"tcpdump -i any port 53 -c 15","result":"Captured 15 DNS queries: resolving api.example.com, db.internal.local, cdn.example.net"}}
{"instruction":"List all connections from specific source IP","input":{},"output":{"tool":"lsof_list_network_connections_files","action":"lsof -i | grep 192.168.1.50","result":"5 connections from 192.168.1.50: 2 SSH sessions, 3 HTTP connections"}}
{"instruction":"Show firewall rules in command format for backup","input":{},"output":{"tool":"iptables_show_firewall_rules_chains","action":"iptables -S","result":"-P INPUT ACCEPT\n-A INPUT -p tcp --dport 22 -j ACCEPT\n-A INPUT -p tcp --dport 80 -j ACCEPT"}}
{"instruction":"Detect what OS the target server is running","input":{},"output":{"tool":"nmap_scan_ports_services_hosts","action":"nmap -O target-server.local","result":"OS detection: Linux 5.15.x (Ubuntu 22.04), SSH banner confirms Ubuntu"}}
{"instruction":"Monitor network path quality over time","input":{},"output":{"tool":"traceroute_mtr_network_path_analysis","action":"mtr --report --report-cycles 30 destination.com","result":"30 cycles: consistent 45ms latency, 0% packet loss, stable route"}}
{"instruction":"Find top IP addresses by connection count","input":{},"output":{"tool":"ss_list_socket_connections_filter","action":"ss -tunap | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -rn","result":"Top IPs: 192.168.1.50(23), 10.0.0.15(12), 203.0.113.45(8)"}}
