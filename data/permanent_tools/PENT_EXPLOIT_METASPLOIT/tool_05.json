{
  "name": "msf_database_workspace_management",
  "description": "Manage Metasploit database, workspaces, hosts, services, credentials",
  "pattern": "msf.*database|workspace.*manage|db.*nmap|hosts.*services",
  "parameters": ["workspace_name"],
  "sequence": [
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'workspace -a {{workspace_name}}; workspace'"]}, "expected_output": {"type": "string", "example": "Added workspace: {{workspace_name}}\n* {{workspace_name}}\n  default"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'workspace {{workspace_name}}; db_nmap -sS -p 80,443 192.168.1.0/24'"]}, "expected_output": {"type": "string", "example": "Nmap scan imported: 23 hosts, 45 services added to database"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'workspace {{workspace_name}}; hosts'"]}, "expected_output": {"type": "string", "example": "Hosts\naddress       mac                name       os_name   os_flavor  os_sp  purpose  info  comments\n192.168.1.100 aa:bb:cc:dd:ee:ff  server01   Linux     Ubuntu     22.04  server"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'workspace {{workspace_name}}; services'"]}, "expected_output": {"type": "string", "example": "Services\nhost          port  proto  name   state  info\n192.168.1.100 80    tcp    http   open   Apache 2.4.52\n192.168.1.100 443   tcp    https  open   nginx 1.18.0"}},
    {"action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "msfconsole -q -x 'workspace {{workspace_name}}; creds'"]}, "expected_output": {"type": "string", "example": "Credentials\nhost          port  user   pass       type  service\n192.168.1.100 22    root   password   plain ssh"}}
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
