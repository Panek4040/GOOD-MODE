{
  "name": "msf_auxiliary_scanner_modules",
  "description": "Use Metasploit auxiliary modules for scanning, enumeration, fuzzing",
  "pattern": "auxiliary.*scan|msf.*scanner|auxiliary.*module|scanner.*auxiliary",
  "parameters": [
    "module_path",
    "rhosts"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'use {{module_path}}; set RHOSTS {{rhosts}}; run'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Scanned 23 of 256 hosts (9% complete)\nFound vulnerable: {{rhosts}} - SMBv1 enabled\nAuxiliary module execution completed"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'use auxiliary/scanner/portscan/tcp; set RHOSTS {{rhosts}}; set PORTS 80,443,445; run'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "{{rhosts}}:80 - TCP OPEN\n{{rhosts}}:443 - TCP OPEN\n{{rhosts}}:445 - TCP OPEN"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'use auxiliary/scanner/smb/smb_version; set RHOSTS {{rhosts}}; run'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "{{rhosts}}:445 - SMB Detected (Windows 10 Build 19044) (name:VICTIM-PC)"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'use auxiliary/scanner/http/http_version; set RHOSTS {{rhosts}}; run'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "{{rhosts}}:80 - Apache/2.4.52 (Ubuntu)\n{{rhosts}}:443 - nginx/1.18.0"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'search type:auxiliary name:scanner platform:windows'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "234 auxiliary scanner modules found for Windows platform"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
