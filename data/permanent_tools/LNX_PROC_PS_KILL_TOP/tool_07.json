{"name":"lsof_list_open_files_ports","description":"List open files and network ports for processes using lsof","pattern":"lsof|open.*files|ports.*process","parameters":["pid","port"],"sequence":[{"action":{"type":"system_command","tool":"shell","operation":"run","command":"lsof","args":["-p","{{pid}}"]},"expected_output":{"type":"string","example":"COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME\npython3 {{pid}} user  cwd    DIR    8,1     4096 1234567 /app\npython3 {{pid}} user  txt    REG    8,1  3456789 2345678 /usr/bin/python3\npython3 {{pid}} user    3u  IPv4 98765432      0t0     TCP *:8080 (LISTEN)"}},{"action":{"type":"system_command","tool":"shell","operation":"run","command":"bash","args":["-c","lsof -p {{pid}} | grep -c ''"]},"expected_output":{"type":"string","example":"47"}},{"action":{"type":"system_command","tool":"shell","operation":"run","command":"lsof","args":["-i",":{{port}}"]},"expected_output":{"type":"string","example":"COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\nnginx   1234 root    6u  IPv4  12345      0t0  TCP *:{{port}} (LISTEN)"}},{"action":{"type":"system_command","tool":"shell","operation":"run","command":"bash","args":["-c","lsof -i -P -n | grep :{{port}}"]},"expected_output":{"type":"string","example":"nginx   1234  root    6u  IPv4  12345      0t0  TCP *:{{port}} (LISTEN)"}}],"stats":{"uses":0,"successes":0,"failures":0,"success_rate":0.0},"created_by":"neural_mesh_v5.2_generator"}
