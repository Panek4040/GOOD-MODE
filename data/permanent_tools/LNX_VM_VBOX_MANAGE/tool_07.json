{
  "name": "vbox_export_import_ova_appliance",
  "description": "Export VM to OVA/OVF appliance format, import OVA files as new VMs",
  "pattern": "export.*vm.*ova|import.*appliance|save.*vm.*file|portable.*vm",
  "parameters": ["vm_name", "operation", "file_path"],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "if [ '{{operation}}' = 'export' ]; then VBoxManage showvminfo '{{vm_name}}' --machinereadable | grep -E 'name=|memory=|cpus=|VMState='; fi"]
      },
      "expected_output": {
        "type": "string",
        "example": "name=\"{{vm_name}}\"\nmemory=4096\ncpus=2\nVMState=\"poweroff\""
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "if [ '{{operation}}' = 'export' ]; then VBoxManage export '{{vm_name}}' --output '{{file_path}}' --ovf20 --manifest --options manifest,iso; elif [ '{{operation}}' = 'import' ]; then VBoxManage import '{{file_path}}' --dry-run; fi"]
      },
      "expected_output": {
        "type": "string",
        "example": "0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%\nSuccessfully exported 1 machine(s)."
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "if [ '{{operation}}' = 'export' ]; then ls -lh '{{file_path}}' && sha256sum '{{file_path}}'; elif [ '{{operation}}' = 'import' ]; then VBoxManage import '{{file_path}}'; fi"]
      },
      "expected_output": {
        "type": "string",
        "example": "-rw-r--r-- 1 user user 2.3G Nov 18 21:30 {{file_path}}\nab12cd34ef56gh78ij90kl12mn34op56qr78st90uv12wx34yz56  {{file_path}}"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "if [ '{{operation}}' = 'import' ]; then VBoxManage list vms | tail -1; fi"]
      },
      "expected_output": {
        "type": "string",
        "example": "\"{{vm_name}}\" {8a9b0c1d-2e3f-4a5b-6c7d-8e9f0a1b2c3d}"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
