{
  "name": "backup_verify_integrity_test_restore",
  "description": "Verify backup integrity, test archive extraction, compare checksums before/after",
  "pattern": "verify.*backup|test.*archive|check.*integrity",
  "parameters": [
    "archive_path",
    "verification_type"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "ls -lh {{archive_path}} && file {{archive_path}}"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "-rw-r--r-- 1 user user 2.3G Nov 18 23:45 {{archive_path}}\n{{archive_path}}: gzip compressed data, from Unix"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "if [ '{{verification_type}}' = 'list' ]; then tar -tzf {{archive_path}} | head -20; elif [ '{{verification_type}}' = 'test' ]; then tar -tzf {{archive_path}} > /dev/null && echo 'Archive OK'; elif [ '{{verification_type}}' = 'extract_test' ]; then mkdir -p /tmp/restore_test && tar -xzf {{archive_path}} -C /tmp/restore_test && echo 'Extraction successful'; fi"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Archive OK"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "sha256sum {{archive_path}}"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456  {{archive_path}}"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "tar -tzf {{archive_path}} | wc -l && du -h {{archive_path}}"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "3847\n2.3G\t{{archive_path}}"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
