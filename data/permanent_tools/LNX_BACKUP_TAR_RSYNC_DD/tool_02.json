{
  "name": "rsync_incremental_sync_backup",
  "description": "Synchronize directories with rsync for incremental backups, preserve permissions",
  "pattern": "rsync.*backup|sync.*directories|incremental.*backup",
  "parameters": [
    "source",
    "destination",
    "sync_options"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "du -sh '{{source}}' && du -sh '{{destination}}' 2>/dev/null || echo '{{destination}} does not exist'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "3.2G\t{{source}}\n2.9G\t{{destination}}"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "rsync",
        "args": [
          "-av",
          "--dry-run",
          "--stats",
          "{{source}}/",
          "{{destination}}/"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Number of files: 1,523 (reg: 1,234, dir: 289)\nNumber of created files: 47\nNumber of deleted files: 12\nTotal file size: 3.2G bytes"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "rsync -av --delete --progress '{{source}}/' '{{destination}}/' 2>&1 | tail -20"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "sent 245.67M bytes  received 12.34K bytes  15.23M bytes/sec\ntotal size is 3.21G  speedup is 13.06"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "du -sh '{{destination}}' && find '{{destination}}' -type f | wc -l"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "3.2G\t{{destination}}\n1234"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
