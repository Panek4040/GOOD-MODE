{
  "name": "passwd_chage_password_management",
  "description": "Change user passwords, set password aging policies, expiration dates, force password change",
  "pattern": "change.*password|passwd.*command|password.*aging|chage.*policy",
  "parameters": ["username", "operation"],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "chage",
        "args": ["-l", "{{username}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "Last password change\t\t\t\t: Nov 18, 2024\nPassword expires\t\t\t\t: never\nPassword inactive\t\t\t\t: never\nAccount expires\t\t\t\t\t: never\nMinimum number of days between password change\t\t: 0\nMaximum number of days between password change\t\t: 99999"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "if [ '{{operation}}' = 'expire_now' ]; then chage -d 0 {{username}}; elif [ '{{operation}}' = 'max_days_90' ]; then chage -M 90 {{username}}; elif [ '{{operation}}' = 'min_days_7' ]; then chage -m 7 {{username}}; elif [ '{{operation}}' = 'warn_14' ]; then chage -W 14 {{username}}; elif [ '{{operation}}' = 'expire_date' ]; then chage -E 2025-12-31 {{username}}; fi"]
      },
      "expected_output": {
        "type": "string",
        "example": ""
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "chage",
        "args": ["-l", "{{username}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "Last password change\t\t\t\t: password must be changed\nPassword expires\t\t\t\t: password must be changed\nPassword inactive\t\t\t\t: password must be changed\nMinimum number of days between password change\t\t: 7\nMaximum number of days between password change\t\t: 90\nNumber of days of warning before password expires\t: 14"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "grep -E '^{{username}}:' /etc/shadow | cut -d: -f3,4,5,6"]
      },
      "expected_output": {
        "type": "string",
        "example": "0:7:90:14"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
