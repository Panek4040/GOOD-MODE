{
  "name": "userdel_delete_user_cleanup_files",
  "description": "Delete user account with options to remove home directory, mail spool, backup files",
  "pattern": "delete.*user|remove.*account|userdel.*command",
  "parameters": ["username", "remove_files"],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "id {{username}} && ls -ld /home/{{username}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "uid=1005({{username}}) gid=1005({{username}}) groups=1005({{username}})\ndrwxr-xr-x 3 {{username}} {{username}} 4096 Nov 18 10:30 /home/{{username}}"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "find / -user {{username}} -type f 2>/dev/null | head -20"]
      },
      "expected_output": {
        "type": "string",
        "example": "/home/{{username}}/.bashrc\n/home/{{username}}/.profile\n/home/{{username}}/documents/file.txt\n/var/spool/mail/{{username}}\n/tmp/{{username}}_temp.log"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "if [ '{{remove_files}}' = 'yes' ]; then userdel -r {{username}}; else userdel {{username}}; fi"]
      },
      "expected_output": {
        "type": "string",
        "example": "userdel: {{username}} mail spool (/var/mail/{{username}}) not found"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "id {{username}} 2>&1 || echo 'User successfully deleted'"]
      },
      "expected_output": {
        "type": "string",
        "example": "id: '{{username}}': no such user\nUser successfully deleted"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": ["-c", "ls -ld /home/{{username}} 2>&1 || echo 'Home directory removed'"]
      },
      "expected_output": {
        "type": "string",
        "example": "ls: cannot access '/home/{{username}}': No such file or directory\nHome directory removed"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
