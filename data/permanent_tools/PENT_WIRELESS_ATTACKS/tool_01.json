{
  "name": "wifi_reconnaissance",
  "description": "WiFi network reconnaissance and monitoring using aircrack-ng suite",
  "pattern": "wifi.*recon|aircrack|airodump|wireless.*scan|802.*11",
  "parameters": ["interface", "channel", "target_bssid"],
  "sequence": [
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "iwconfig", "args": []},
      "expected_output": {"type": "string", "example": "lo        no wireless extensions.\n\neth0      no wireless extensions.\n\nwlan0     IEEE 802.11  ESSID:off/any  \n          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   \n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:off\n          \nwlan0mon  IEEE 802.11  Mode:Monitor  Frequency:2.457 GHz  Tx-Power=20 dBm   \n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:off\n\nWireless interfaces detected:\n  wlan0: Managed mode (normal operation)\n  wlan0mon: Monitor mode (packet capture)\n  \nIf wlan0mon exists: Already in monitor mode\nIf not: Need to enable monitor mode with airmon-ng"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "airmon-ng", "args": ["start", "wlan0"]},
      "expected_output": {"type": "string", "example": "PHY\tInterface\tDriver\t\tChipset\n\nphy0\twlan0\t\trtl8187\t\tRealtek Semiconductor Corp. RTL8187\n\n\t\t(mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon)\n\t\t(mac80211 station mode vif disabled for [phy0]wlan0)\n\nMonitor mode enabled!\n  Physical interface: phy0\n  Wireless interface: wlan0\n  Monitor interface: wlan0mon (created)\n  Driver: rtl8187\n  Chipset: Realtek RTL8187\n  \nInterface wlan0mon is now in monitor mode:\n  - Can capture all WiFi packets in range\n  - Can inject packets\n  - Ready for airodump-ng, aireplay-ng\n  \nNote: Killing interfering processes:\n  - NetworkManager\n  - wpa_supplicant\n  - dhclient"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "airodump-ng", "args": ["wlan0mon"]},
      "expected_output": {"type": "string", "example": "CH  6 ][ Elapsed: 1 min ][ 2024-01-15 14:30\n\n BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID\n\n AA:BB:CC:DD:EE:FF  -42      287      156    8   6  130   WPA2 CCMP   PSK  CorporateWiFi\n 11:22:33:44:55:66  -67      145       23    1  11   54   WPA2 CCMP   PSK  HomeNetwork  \n 77:88:99:AA:BB:CC  -75       98        0    0   1   54   WPA2 CCMP   PSK  NETGEAR84\n DD:EE:FF:00:11:22  -38      324      892   45   6  130   WPA2 CCMP   PSK  OfficeMain\n 33:44:55:66:77:88  -82       67        2    0   6   54   WEP  WEP         OldRouter\n A1:B2:C3:D4:E5:F6  -55      156       89    4  11  130   WPA2 CCMP   MGT  Enterprise-Net\n\n BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes\n\n AA:BB:CC:DD:EE:FF  12:34:56:78:90:AB  -45    0e- 1e     0       87  \n DD:EE:FF:00:11:22  AB:CD:EF:12:34:56  -36    1e- 6e     0      523  \n DD:EE:FF:00:11:22  56:78:90:AB:CD:EF  -42   24e-24e     1      267  \n A1:B2:C3:D4:E5:F6  98:76:54:32:10:FE  -52    0e-24e    12       45  \n\nWiFi networks discovered:\n  1. CorporateWiFi (Ch 6, WPA2, -42 dBm, HIGH signal, 156 data packets)\n     - 1 client connected\n  2. OfficeMain (Ch 6, WPA2, -38 dBm, VERY HIGH signal, 892 data packets)\n     - 2 clients: AB:CD:EF:12:34:56, 56:78:90:AB:CD:EF\n  3. Enterprise-Net (Ch 11, WPA2-Enterprise, -55 dBm, MEDIUM signal)\n     - 1 client\n  4. OldRouter (Ch 6, WEP, -82 dBm, LOW signal)\n     - No clients, vulnerable WEP\n  \nBest targets:\n  - OfficeMain: Strong signal, active clients (easy handshake capture)\n  - OldRouter: WEP encryption (trivial to crack)\n  - CorporateWiFi: Active traffic"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "airodump-ng", "args": ["-c", "6", "--bssid", "DD:EE:FF:00:11:22", "-w", "capture", "wlan0mon"]},
      "expected_output": {"type": "string", "example": "CH  6 ][ Elapsed: 3 mins ][ 2024-01-15 14:33 ][ WPA handshake: DD:EE:FF:00:11:22\n\n BSSID              PWR RXQ  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID\n\n DD:EE:FF:00:11:22  -38 100      892     2847   15   6  130   WPA2 CCMP   PSK  OfficeMain\n\n BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes\n\n DD:EE:FF:00:11:22  AB:CD:EF:12:34:56  -36   54e-54e     0     1247  EAPOL\n DD:EE:FF:00:11:22  56:78:90:AB:CD:EF  -42   48e-54e     3      823  EAPOL\n\nFocused capture on target:\n  Target BSSID: DD:EE:FF:00:11:22 (OfficeMain)\n  Channel: 6 (locked)\n  Encryption: WPA2-PSK\n  Signal: -38 dBm (excellent)\n  \nClients observed:\n  1. AB:CD:EF:12:34:56 (-36 dBm, 1247 frames)\n  2. 56:78:90:AB:CD:EF (-42 dBm, 823 frames)\n  \nWPA handshake captured!\n  BSSID: DD:EE:FF:00:11:22\n  Status: WPA handshake captured for both clients\n  Files created:\n    - capture-01.cap (pcap file with handshake)\n    - capture-01.csv (network details)\n    - capture-01.kismet.csv (kismet format)\n  \nHandshake is required for offline cracking with aircrack-ng/hashcat"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "wash", "args": ["-i", "wlan0mon"]},
      "expected_output": {"type": "string", "example": "BSSID               Ch  dBm  WPS  Lck  Vendor    ESSID\n--------------------------------------------------------------------------------\nAA:BB:CC:DD:EE:FF    6  -42  2.0  No   Cisco     CorporateWiFi\n11:22:33:44:55:66   11  -67  2.0  No   Netgear   HomeNetwork\nDD:EE:FF:00:11:22    6  -38  2.0  No   Linksys   OfficeMain\n99:88:77:66:55:44    1  -73  1.0  No   TP-Link   GuestNet\n\nWPS-enabled networks discovered:\n  4 networks with WPS enabled\n  All show 'Lck: No' = WPS NOT locked\n  \nWPS vulnerabilities:\n  - WPS PIN brute-force possible (reaver)\n  - Pixie Dust attack possible (pixiewps)\n  - 8-digit PIN (10^8 possibilities, but only 11,000 due to checksum)\n  \nWPS versions:\n  - v2.0: Modern, may have rate limiting\n  - v1.0: Older, easier to attack\n  \nBest WPS targets:\n  - 99:88:77:66:55:44 (GuestNet, WPS 1.0, no lock)\n  - DD:EE:FF:00:11:22 (OfficeMain, WPS 2.0, good signal)"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "airodump-ng", "args": ["--manufacturer", "wlan0mon"]},
      "expected_output": {"type": "string", "example": "CH  6 ][ Elapsed: 1 min ][ 2024-01-15 14:35\n\n BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC  CIPHER AUTH ESSID              Manufacturer\n\n AA:BB:CC:DD:EE:FF  -42      287      156    8   6  130  WPA2 CCMP   PSK  CorporateWiFi      Cisco Systems\n 11:22:33:44:55:66  -67      145       23    1  11   54  WPA2 CCMP   PSK  HomeNetwork        Netgear\n 77:88:99:AA:BB:CC  -75       98        0    0   1   54  WPA2 CCMP   PSK  NETGEAR84          Netgear\n DD:EE:FF:00:11:22  -38      324      892   45   6  130  WPA2 CCMP   PSK  OfficeMain         Linksys\n 33:44:55:66:77:88  -82       67        2    0   6   54  WEP  WEP         OldRouter          D-Link\n A1:B2:C3:D4:E5:F6  -55      156       89    4  11  130  WPA2 CCMP   MGT  Enterprise-Net     Cisco Systems\n\nManufacturer information:\n  Helps identify router models and default credentials\n  Common vulnerabilities by vendor:\n    - D-Link: Known WPS vulnerabilities, default admin passwords\n    - Netgear: WPS Pixie Dust vulnerable on older models\n    - Linksys: Some models have backdoor accounts\n    - Cisco: Generally more secure, but enterprise configs can be misconfigured"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "kismet", "args": ["-c", "wlan0mon"]},
      "expected_output": {"type": "string", "example": "INFO: Kismet 2022.08.R1 started\nINFO: Opened monitor source 'wlan0mon' (802.11)\nINFO: Starting webserver on http://localhost:2501\nINFO: Visit http://localhost:2501 for web interface\n\n[After 5 minutes of capture]\n\nNetworks detected: 12\n  - 8 WPA2-PSK\n  - 1 WEP\n  - 2 WPA2-Enterprise\n  - 1 Open (no encryption)\n  \nClients detected: 47\n  - 32 associated with networks\n  - 15 probing (searching for networks)\n  \nInteresting findings:\n  - Client 12:34:56:78:90:AB probing for 'attwifi' (public hotspot)\n  - Hidden SSID discovered: 'AdminNetwork' (BSSID: F1:F2:F3:F4:F5:F6)\n  - Rogue AP detected: 'Free_WiFi' (identical BSSID to legitimate network)\n  \nKismet advantages:\n  - Web interface for real-time monitoring\n  - Automatic channel hopping\n  - GPS integration (wardriving)\n  - Detects hidden SSIDs\n  - Identifies rogue APs\n  - Logs to database for later analysis"}
    }
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
