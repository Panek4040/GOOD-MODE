{
  "name": "docker_build_image_from_dockerfile",
  "description": "Build Docker image from Dockerfile with tags and build arguments verification",
  "pattern": "build.*docker.*image|create.*container.*image|dockerfile.*build",
  "parameters": ["dockerfile_path", "image_tag", "build_context"],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "docker",
        "args": ["version", "--format", "{{.Server.Version}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "24.0.7"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "cat",
        "args": ["{{dockerfile_path}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "FROM ubuntu:22.04\nRUN apt-get update && apt-get install -y nginx\nEXPOSE 80\nCMD [\"nginx\", \"-g\", \"daemon off;\"]"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "docker",
        "args": ["build", "-t", "{{image_tag}}", "-f", "{{dockerfile_path}}", "{{build_context}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "[+] Building 45.2s (8/8) FINISHED\n => [internal] load build definition from Dockerfile\n => [internal] load metadata for docker.io/library/ubuntu:22.04\n => [1/3] FROM docker.io/library/ubuntu:22.04@sha256:abc123\n => [2/3] RUN apt-get update && apt-get install -y nginx\n => [3/3] EXPOSE 80\n => exporting to image\n => => writing image sha256:def456\n => => naming to docker.io/library/{{image_tag}}"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "docker",
        "args": ["images", "{{image_tag}}", "--format", "table {{.Repository}}\\t{{.Tag}}\\t{{.Size}}\\t{{.ID}}"]
      },
      "expected_output": {
        "type": "string",
        "example": "REPOSITORY          TAG       SIZE      IMAGE ID\nmyapp               latest    142MB     def456789abc"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "docker",
        "args": ["history", "{{image_tag}}", "--no-trunc"]
      },
      "expected_output": {
        "type": "string",
        "example": "IMAGE          CREATED        CREATED BY                                      SIZE      COMMENT\ndef456789abc   2 minutes ago  CMD [\"nginx\" \"-g\" \"daemon off;\"]                 0B\n<missing>      2 minutes ago  EXPOSE 80                                       0B\n<missing>      2 minutes ago  RUN apt-get update && apt-get install -y nginx  52MB"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
